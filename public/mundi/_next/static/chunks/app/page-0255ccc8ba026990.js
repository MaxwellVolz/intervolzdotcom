(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{444:(e,t,n)=>{Promise.resolve().then(n.bind(n,3184))},3184:(e,t,n)=>{"use strict";n.d(t,{default:()=>b});var o=n(5155),r=n(258),l=n(9336),s=n(6750),i=n(8381),a=n(2115),c=n(6923);function d(e){let{node:t,position:n,visible:r=!0,opacity:l=1}=e,[s,i]=(0,a.useState)(!1);return r?(0,o.jsxs)("group",{position:n,children:[(0,o.jsx)(c.E,{position:[0,0,0],fontSize:.2,color:s?"#60a5fa":"white",anchorX:"center",anchorY:"middle",outlineWidth:.02,outlineColor:"#000000",fillOpacity:l,outlineOpacity:.5*l,onPointerOver:()=>i(!0),onPointerOut:()=>i(!1),children:t.label}),t.description&&s&&(0,o.jsx)(c.E,{position:[0,-.3,0],fontSize:.12,color:"#9ca3af",anchorX:"center",anchorY:"top",maxWidth:2,fillOpacity:l,children:t.description})]}):null}var u=n(1770),p=n(5339);function h(e){let{start:t,end:n,color:r="#3b82f6",opacity:l=.6,animated:s=!1,progress:i=1}=e,c=(0,a.useMemo)(()=>{let e=[new p.Pq0(...t),new p.Pq0(...n)],o=new p.LoY().setFromPoints(e),s=new p.mrM({color:r,transparent:!0,opacity:l,linewidth:2});return new p.N1A(o,s)},[]);return(0,a.useMemo)(()=>{if(i<1){let e=new p.Pq0(...t),o=new p.Pq0(...n),r=e.lerp(o,i),l=[new p.Pq0(...t),r];c.geometry.setFromPoints(l)}else{let e=[new p.Pq0(...t),new p.Pq0(...n)];c.geometry.setFromPoints(e)}},[t,n,i,c]),(0,u.D)(()=>{let e=c.material;e.color.set(r),e.opacity=s?l*i:l}),(0,o.jsx)("primitive",{object:c})}function g(e){let{level:t,depth:n,visible:r=!0,opacity:l=1,showConnections:s=!0,visibleNodeIds:i}=e,a=t.spacing||2,c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(1===e)return[[0,0]];let n=[],o=t*e/(2*Math.PI);for(let t=0;t<e;t++){let r=t/e*Math.PI*2,l=Math.cos(r)*o,s=Math.sin(r)*o;n.push([l,s])}return n}(t.nodes.length,a),u=t.nodes.map((e,t)=>{var o,r,l,s;let[i,a]=c[t];return[null!=(l=null==(o=e.position)?void 0:o[0])?l:i,null!=(s=null==(r=e.position)?void 0:r[1])?s:a,n]});return(0,o.jsxs)("group",{position:[0,0,0],children:[s&&r&&t.nodes.length>1&&(0,o.jsx)(o.Fragment,{children:t.nodes.slice(0,-1).map((e,t)=>{let n=t+1;return(0,o.jsx)(h,{start:u[t],end:u[n],color:"#3b82f6",opacity:.4*l},"connection-".concat(t,"-").concat(n))})}),(0,o.jsx)("group",{position:[0,0,n],children:t.nodes.map((e,t)=>{var n,s,a,u;let[p,h]=c[t],g=[null!=(a=null==(n=e.position)?void 0:n[0])?a:p,null!=(u=null==(s=e.position)?void 0:s[1])?u:h,0],m=i?i.has(e.id):r;return(0,o.jsx)(d,{node:e,position:g,visible:m,opacity:l},e.id)})})]})}function m(e){let{atlas:t,levelSpacing:n=5,visibleNodes:r,visibleConnections:l,lineProgress:s,currentLevel:i=0}=e,a=t.levels.map((e,t)=>{let o=t*n,r=e.spacing||2,l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(1===e)return[[0,0]];let n=[],o=t*e/(2*Math.PI);for(let t=0;t<e;t++){let r=t/e*Math.PI*2,l=Math.cos(r)*o,s=Math.sin(r)*o;n.push([l,s])}return n}(e.nodes.length,r);return e.nodes.map((e,t)=>{var n,r,s,i;let[a,c]=l[t];return{id:e.id,position:[null!=(s=null==(n=e.position)?void 0:n[0])?s:a,null!=(i=null==(r=e.position)?void 0:r[1])?i:c,o]}})});return(0,o.jsxs)("group",{children:[t.levels.map((e,t)=>{let l=e.nodes.filter(e=>r.has(e.id)).map(e=>e.id),s=Math.abs(t-i),a=1;return 1===s?a=.4:2===s?a=.15:s>=3&&(a=.05),(0,o.jsx)(g,{level:e,depth:t*n,visible:!0,opacity:a,showConnections:!1,visibleNodeIds:new Set(l)},"".concat(e.name,"-").concat(t))}),t.levels.map((e,t)=>{let n=a[t],r=Math.abs(t-i),c=1;return 1===r?c=.4:2===r?c=.15:r>=3&&(c=.05),e.nodes.slice(0,-1).map((t,r)=>{let i="".concat(e.name,"-").concat(r,"-").concat(r+1),a=s.get(i)||0;if(!(l.has(i)||a>0))return null;let d=n[r].position,u=n[r+1].position,p=[d[0],d[1],d[2]-.1],g=[u[0],u[1],u[2]-.1];return(0,o.jsx)(h,{start:p,end:g,color:"#3b82f6",opacity:.6*c,animated:a<1,progress:a},i)})}),t.levels.map((e,n)=>{if(n>=t.levels.length-1)return null;let r=a[n],c=a[n+1],d="inter-".concat(n),u=s.get(d)||0;if(!(l.has(d)||u>0))return null;let p=(Math.abs(n-i)+Math.abs(n+1-i))/2,g=1;p>=2.5?g=.05:p>=1.5?g=.15:p>=.5&&(g=.4);let m=r[r.length-1].position,f=c[0].position,v=[m[0],m[1],m[2]-.1],b=[f[0],f[1],f[2]-.1];return(0,o.jsx)(h,{start:v,end:b,color:"#60a5fa",opacity:.6*g,animated:u<1,progress:u},d)})]})}function f(e){let{state:t,controls:n}=e,{hasStarted:r,isPlaying:l,currentStep:s,totalSteps:i}=t;return console.log("AnimationControlsUI render:",{hasStarted:r,isPlaying:l,currentStep:s,totalSteps:i}),(0,o.jsx)("div",{style:{position:"fixed",bottom:"2rem",left:"50%",transform:"translateX(-50%)",pointerEvents:"none",zIndex:1e3},children:(0,o.jsx)("div",{style:{pointerEvents:"auto",display:"flex",alignItems:"center",gap:"1rem",backgroundColor:"rgba(17, 24, 39, 0.9)",backdropFilter:"blur(8px)",padding:"1rem 1.5rem",borderRadius:"9999px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.5)",border:"1px solid rgba(55, 65, 81, 0.5)"},children:r?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{onClick:n.previous,disabled:0===s,style:{padding:"0.5rem",backgroundColor:"transparent",border:"none",cursor:0===s?"not-allowed":"pointer",opacity:0===s?.3:1,borderRadius:"9999px",transition:"background-color 0.2s"},onMouseEnter:e=>{0!==s&&(e.currentTarget.style.backgroundColor="rgba(31, 41, 55, 1)")},onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",title:"Previous",children:(0,o.jsx)("svg",{style:{width:"1.5rem",height:"1.5rem",color:"white"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,o.jsx)("button",{onClick:l?n.pause:n.resume,style:{padding:"0.75rem",backgroundColor:"#2563eb",border:"none",cursor:"pointer",borderRadius:"9999px",transition:"background-color 0.2s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#1d4ed8",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#2563eb",title:l?"Pause":"Play",children:l?(0,o.jsx)("svg",{style:{width:"1.5rem",height:"1.5rem",color:"white"},fill:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):(0,o.jsx)("svg",{style:{width:"1.5rem",height:"1.5rem",color:"white"},fill:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{d:"M8 5v14l11-7z"})})}),(0,o.jsx)("button",{onClick:n.next,disabled:s>=i-1,style:{padding:"0.5rem",backgroundColor:"transparent",border:"none",cursor:s>=i-1?"not-allowed":"pointer",opacity:s>=i-1?.3:1,borderRadius:"9999px",transition:"background-color 0.2s"},onMouseEnter:e=>{s<i-1&&(e.currentTarget.style.backgroundColor="rgba(31, 41, 55, 1)")},onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",title:"Next",children:(0,o.jsx)("svg",{style:{width:"1.5rem",height:"1.5rem",color:"white"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,o.jsx)("div",{style:{marginLeft:"1rem",paddingLeft:"1rem",borderLeft:"1px solid rgba(55, 65, 81, 1)"},children:(0,o.jsxs)("div",{style:{fontSize:"0.875rem",color:"#9ca3af"},children:[s+1," / ",i]})}),(0,o.jsx)("button",{onClick:n.reset,style:{padding:"0.5rem",marginLeft:"0.5rem",backgroundColor:"transparent",border:"none",cursor:"pointer",borderRadius:"9999px",transition:"background-color 0.2s"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="rgba(31, 41, 55, 1)",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",title:"Reset",children:(0,o.jsx)("svg",{style:{width:"1.25rem",height:"1.25rem",color:"#9ca3af"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}):(0,o.jsx)("button",{onClick:()=>{console.log("Begin Journey clicked"),n.start()},style:{padding:"0.75rem 2rem",backgroundColor:"#2563eb",color:"white",fontSize:"1.125rem",fontWeight:600,borderRadius:"9999px",border:"none",cursor:"pointer"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#1d4ed8",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#2563eb",children:"Begin Journey"})})})}function v(e){let{targetLevel:t,levelSpacing:n=5,animationDuration:o=1}=e,{camera:r}=(0,u.C)(),l=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=new p.Pq0(0,0,5+5*t);.1>r.position.distanceTo(e)||(console.log("Camera animating to level ".concat(t),{from:r.position.toArray(),to:e.toArray()}),l.current={startPosition:r.position.clone(),targetPosition:e,startTime:Date.now(),duration:1e3*o})},[t,r,n,o]),(0,u.D)(()=>{if(!l.current)return;let{startPosition:e,targetPosition:o,startTime:s,duration:i}=l.current,a=Math.min((Date.now()-s)/i,1),c=a<.5?4*a*a*a:1-Math.pow(-2*a+2,3)/2;r.position.lerpVectors(e,o,c);let d=t*n;r.lookAt(0,0,d),a>=1&&(l.current=null)}),null}function b(){let{atlas:e,loading:t,error:n}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/data/atlas.json",[t,n]=(0,a.useState)(null),[o,r]=(0,a.useState)(!0),[l,s]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let t=!0;return async function(){try{r(!0),s(null);let o=await fetch(e);if(!o.ok)throw Error("Failed to load atlas: ".concat(o.status," ").concat(o.statusText));let l=await o.json();if(!l.levels||!Array.isArray(l.levels))throw Error("Invalid atlas format: missing or invalid levels array");t&&n(l)}catch(e){t&&s(e instanceof Error?e:Error("Unknown error loading atlas"))}finally{t&&r(!1)}}(),()=>{t=!1}},[e]),{atlas:t,loading:o,error:l}}(),{state:c,controls:d}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,[n,o]=(0,a.useState)({currentStep:0,totalSteps:0,isPlaying:!1,hasStarted:!1,speed:t});(0,a.useEffect)(()=>{if(e){let t,n=(t=0,e.levels.forEach(e=>{t+=e.nodes.length}),1+t+(t-1));console.log("Total animation steps: ".concat(n)),o(e=>({...e,totalSteps:n}))}},[e]),(0,a.useEffect)(()=>{if(!n.isPlaying)return;console.log("Auto-advancing from step ".concat(n.currentStep," to ").concat(n.currentStep+1));let e=setTimeout(()=>{o(e=>e.currentStep>=e.totalSteps-1?(console.log("Animation complete"),{...e,isPlaying:!1}):{...e,currentStep:e.currentStep+1})},n.speed);return()=>clearTimeout(e)},[n.isPlaying,n.currentStep,n.speed,n.totalSteps]);let r=(0,a.useCallback)(()=>{console.log("Animation started"),o(e=>({...e,currentStep:0,isPlaying:!0,hasStarted:!0}))},[]),l=(0,a.useCallback)(()=>{o(e=>({...e,isPlaying:!1}))},[]),s=(0,a.useCallback)(()=>{o(e=>({...e,isPlaying:!0}))},[]),i=(0,a.useCallback)(()=>{o(e=>({...e,currentStep:Math.min(e.currentStep+1,e.totalSteps-1),hasStarted:!0}))},[]),c=(0,a.useCallback)(()=>{o(e=>({...e,currentStep:Math.max(e.currentStep-1,0)}))},[]),d=(0,a.useCallback)(()=>{o(e=>({...e,currentStep:0,isPlaying:!1,hasStarted:!1}))},[]);return{state:n,controls:{start:r,pause:l,resume:s,next:i,previous:c,reset:d,goToStep:(0,a.useCallback)(e=>{o(t=>({...t,currentStep:Math.max(0,Math.min(e,t.totalSteps-1)),hasStarted:!0}))},[])}}}(e,1500),u=(0,a.useMemo)(()=>{if(!e)return{visibleNodes:new Set,visibleConnections:new Set,lineProgress:new Map};let t=function(e,t){let n=new Set,o=new Set,r=new Map;if(t<=0)return{visibleNodes:n,visibleConnections:o,lineProgress:r};let l=1,s=null;e.levels.length>0&&e.levels[0].nodes.length>0&&(n.add(e.levels[0].nodes[0].id),l++);for(let i=0;i<e.levels.length;i++){let a=e.levels[i],c=0===i;for(let e=0;e<a.nodes.length;e++){let d,u=a.nodes[e],p=0===e;(!c||!p)&&(d=p&&s?"inter-".concat(i-1):"".concat(a.name,"-").concat(e-1,"-").concat(e),t>=l&&(o.add(d),r.set(d,1),l++),t>=l&&(n.add(u.id),l++))}a.nodes.length>0&&(s=a.nodes[a.nodes.length-1].id)}return{visibleNodes:n,visibleConnections:o,lineProgress:r}}(e,c.currentStep);return console.log("Step ".concat(c.currentStep,":"),{visibleNodes:Array.from(t.visibleNodes),visibleConnections:Array.from(t.visibleConnections),lineProgress:Array.from(t.lineProgress.entries())}),t},[e,c.currentStep]),p=(0,a.useMemo)(()=>e?function(e,t){if(t<=0)return 0;let n=1;e.levels.length>0&&e.levels[0].nodes.length>0&&n++;for(let o=0;o<e.levels.length;o++){let r=e.levels[o],l=0===o;for(let e=0;e<r.nodes.length;e++){let r=0===e;if((!l||!r)&&(t<++n||t<++n))return o}}return e.levels.length-1}(e,c.currentStep):0,[e,c.currentStep]);return((0,a.useEffect)(()=>{e&&(console.log("Atlas loaded:",e),console.log("Levels: ".concat(e.levels.length)),e.levels.forEach((e,t)=>{console.log("  Level ".concat(t,": ").concat(e.name," (").concat(e.nodes.length," nodes)"))}))},[e]),t)?(0,o.jsx)("div",{id:"canvas-container",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsx)("p",{style:{color:"white"},children:"Loading atlas..."})}):n?(0,o.jsx)("div",{id:"canvas-container",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsxs)("p",{style:{color:"red"},children:["Error loading atlas: ",n.message]})}):e?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{id:"canvas-container",children:(0,o.jsxs)(r.Hl,{children:[(0,o.jsx)(l.u,{makeDefault:!0,position:[0,0,5],fov:75}),(0,o.jsx)(s.N,{enableDamping:!0,dampingFactor:.05,minDistance:2,maxDistance:50}),(0,o.jsx)(v,{targetLevel:p,levelSpacing:5,animationDuration:1.5}),(0,o.jsx)("ambientLight",{intensity:.2,color:"#1e3a8a"}),(0,o.jsx)("directionalLight",{position:[10,10,5],intensity:.4,color:"#60a5fa"}),(0,o.jsx)("directionalLight",{position:[-10,-10,-5],intensity:.3,color:"#3b82f6"}),(0,o.jsx)("pointLight",{position:[0,0,0],intensity:1,color:"#60a5fa",distance:25,decay:2}),(0,o.jsx)("pointLight",{position:[0,5,10],intensity:.6,color:"#93c5fd",distance:15,decay:2}),(0,o.jsx)("spotLight",{position:[0,10,5],angle:.6,penumbra:1,intensity:.8,color:"#60a5fa",castShadow:!1}),(0,o.jsx)("fog",{attach:"fog",args:["#000510",8,35]}),(0,o.jsx)(m,{atlas:e,levelSpacing:5,visibleNodes:u.visibleNodes,visibleConnections:u.visibleConnections,lineProgress:u.lineProgress,currentLevel:p}),(0,o.jsxs)(i.s0,{children:[(0,o.jsx)(i.fE,{offset:.3,darkness:.9,eskil:!1}),(0,o.jsx)(i.mK,{intensity:.5,luminanceThreshold:.2,luminanceSmoothing:.9,height:300})]})]})}),(0,o.jsx)(f,{state:c,controls:d})]}):(0,o.jsx)("div",{id:"canvas-container",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsx)("p",{style:{color:"white"},children:"No atlas data available"})})}}},e=>{e.O(0,[367,831,664,794,683,413,980,441,255,358],()=>e(e.s=444)),_N_E=e.O()}]);
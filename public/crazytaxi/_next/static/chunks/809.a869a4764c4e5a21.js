(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[809],{4809:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>g});var a=i(5155),s=i(2115),l=i(1847);let n=(0,l.A)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),o=(0,l.A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var r=i(5921),c=i(3511),u=i(7909),d=i(8774),p=i(4476),h=i(3381),x=i.n(h),k=i(8615),v=i.n(k),f=i(9135),y=i.n(f),m=i(6620),w=i.n(m);let _=(0,u.default)(()=>Promise.all([i.e(687),i.e(443),i.e(506)]).then(i.bind(i,506)),{loadableGenerated:{webpack:()=>[506]},ssr:!1});function g(e){var t;let{onComplete:i,onGoBack:l}=e,[u,h]=(0,s.useState)(0),[k,f]=(0,s.useState)("tutorial-taxi-1"),[m,g]=(0,s.useState)(!1),[b,N]=(0,s.useState)(!0),{taxisRef:T,deliveriesRef:j,pickupNodesRef:C,deliveryTimerRef:R}=function(){let e=(0,s.useRef)([{id:"tutorial-taxi-1",state:"driving_to_pickup",path:null,t:0,speed:1.5,isFocused:!1,currentIntersectionId:void 0,incomingDir:0,previousNodeId:void 0,hasPackage:!1,currentDeliveryId:void 0,money:0,isReversing:!1,collisionCooldown:0,isReady:!1}]),t=(0,s.useRef)([]),i=(0,s.useRef)(1e4),a=(0,s.useRef)([]),l=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{let i=i=>{let{network:s}=i.detail;if(console.log("\uD83D\uDCDA Tutorial received road network update:",s),s.paths.length>0&&e.current[0]){let t=s.paths[0];e.current[0].path=t,e.current[0].t=0,e.current[0].isReady=!0,console.log("âœ… Tutorial taxi on path: ".concat(t.id)),console.log("   Total paths: ".concat(s.paths.length))}if(s.nodes){let e=s.nodes.filter(e=>e.types.includes("pickup"));if(a.current=e,console.log("\uD83D\uDCCD Tutorial has ".concat(e.length," pickup nodes")),e.length>=2&&!l.current){for(let i=0;i<2;i++){let i=(0,d.aK)(e,t.current);i&&t.current.push(i)}l.current=!0,console.log("\uD83C\uDFAE Tutorial spawned 2 initial deliveries")}}};return window.addEventListener("roadNetworkUpdated",i),()=>{window.removeEventListener("roadNetworkUpdated",i)}},[]),{taxisRef:e,deliveriesRef:t,pickupNodesRef:a,deliveryTimerRef:i}}(),D=[{title:"Yo, what up. First day?",description:"It's easy. The taxis will stay on the road, you just gotta direct them to the biggest packages."},{title:"Plus the controls are pretty chill.",description:"Tap an intersection to set the vibe. The next cab that rolls through will know what to do."},{title:"Just follow the neon lights.",description:"Once you pickup a box, the cabs underglow will match the dropoff rings. Get it there ASAP."}],S=D[u],E=(0,s.useCallback)(e=>{f(t=>t===e?null:e)},[]),P=(0,s.useCallback)(()=>{f(null)},[]),A=(0,s.useCallback)(()=>{g(e=>!e)},[]);return(0,s.useEffect)(()=>{let e=e=>{" "===e.key&&(e.preventDefault(),A())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[A]),(0,a.jsxs)("div",{className:w().tutorialContainer,children:[(0,a.jsx)(_,{taxisRef:T,deliveriesRef:j,pickupNodesRef:C,deliveryTimerRef:R,followTaxiId:k,isPaused:m}),(0,a.jsxs)("div",{className:w().tutorialOverlay,children:[(0,a.jsx)(p.l,{taxisRef:T,onTaxiSelect:E,onResetCamera:P,selectedTaxiId:k}),(0,a.jsxs)("div",{className:y().topLeft,style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,a.jsx)("button",{className:x().icon,onClick:()=>{i()},title:"Start Game",children:(0,a.jsx)(n,{size:24})}),(0,a.jsx)("button",{className:x().icon,onClick:()=>{l&&l()},title:"Go Back to Menu",children:(0,a.jsx)(o,{size:24})})]}),(0,a.jsx)("div",{className:y().bottomRight,children:(0,a.jsx)("button",{className:x().icon,onClick:A,children:m?(0,a.jsx)(r.A,{size:24}):(0,a.jsx)(c.A,{size:24})})}),(0,a.jsxs)("div",{className:v().moneyDisplay,children:["$",(null==(t=T.current[0])?void 0:t.money)||0]}),b&&(0,a.jsxs)("div",{className:w().instructionPanel,children:[(0,a.jsx)("h2",{className:w().stepTitle,children:S.title}),(0,a.jsx)("p",{className:w().stepDescription,children:S.description}),(0,a.jsxs)("div",{className:w().buttonGroup,children:[u>0&&(0,a.jsx)("button",{className:x().secondary,onClick:()=>{u>0&&h(u-1)},children:"Previous"}),(0,a.jsx)("button",{className:x().primary,onClick:()=>{u<D.length-1?h(u+1):N(!1)},children:u<D.length-1?"Next":"Play Tutorial"})]})]})]})]})}},6620:e=>{e.exports={tutorialContainer:"TutorialScene_tutorialContainer__JYRcU",tutorialOverlay:"TutorialScene_tutorialOverlay__Ur0l0",instructionPanel:"TutorialScene_instructionPanel__kcusO",stepTitle:"TutorialScene_stepTitle__EZ_Op",stepDescription:"TutorialScene_stepDescription__V1U_R",buttonGroup:"TutorialScene_buttonGroup__6nSDN"}}}]);
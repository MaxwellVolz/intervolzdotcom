(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{127:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var o=n(5155),i=n(2115),a=n(8661),r=n.n(a),s=n(7909),c=n(8946),l=n(8774);function d(e){let{taxisRef:t,onGameOver:n,isPaused:a,onTogglePause:s,onRushHourChange:l}=e,[d,f]=(0,i.useState)(0),[u,p]=(0,i.useState)(1),[x,h]=(0,i.useState)(300),[g,m]=(0,i.useState)(120),[b,j]=(0,i.useState)(0),[w,v]=(0,i.useState)(Date.now()),[y,D]=(0,i.useState)(!1),[k,N]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=setInterval(()=>{let e=t.current.reduce((e,t)=>e+t.money,0);if(f(e),p(t.current.length),a)v(Date.now());else{let t=Date.now(),o=(t-w)/1e3;v(t);let i=b+o;j(i);let a=Math.max(0,120-i);m(a),a<=30&&a>0&&!y&&(D(!0),N(!0),null==l||l(!0),setTimeout(()=>{N(!1)},3e3)),a<=0&&n(e)}},100);return()=>clearInterval(e)},[t,n,a,b,w]);let I=d>=x,_=Math.floor(g);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"jsx-8714994f2fc6f949 top-bar",children:[(0,o.jsxs)("div",{className:"jsx-8714994f2fc6f949 taxi-info",children:["Taxis: ",u]}),(0,o.jsxs)("button",{onClick:()=>{if(d<x)return void console.log("❌ Not enough money! Need $".concat(x,", have $").concat(d));let e=(0,c.nt)();if(0===e.paths.length)return void console.warn("⚠️ No paths available to spawn taxi");let n=e.paths.filter(e=>e.id.includes("Intersection")),o=n.length>0?n[Math.floor(Math.random()*n.length)]:e.paths[0],i={id:"taxi-".concat(t.current.length+1),state:"driving_to_pickup",path:o,t:0,speed:1.5,isFocused:!1,currentIntersectionId:void 0,incomingDir:0,previousNodeId:void 0,hasPackage:!1,currentDeliveryId:void 0,money:-x,isReversing:!1,collisionCooldown:0};t.current.push(i),console.log("\uD83D\uDE95 Spawned ".concat(i.id," on path ").concat(o.id," for $").concat(x)),h(x+100)},disabled:!I,className:"jsx-8714994f2fc6f949 spawn-button",children:["+ Spawn Taxi ($",x,")"]})]}),(0,o.jsx)("div",{className:"jsx-8714994f2fc6f949 pause-container",children:(0,o.jsx)("button",{onClick:s,className:"jsx-8714994f2fc6f949 pause-button",children:a?"▶":"❚❚"})}),(0,o.jsx)("div",{className:"jsx-8714994f2fc6f949 timer-display",children:_}),(0,o.jsxs)("div",{className:"jsx-8714994f2fc6f949 money-display",children:["$",d]}),k&&(0,o.jsx)("div",{className:"jsx-8714994f2fc6f949 rush-hour-banner",children:(0,o.jsx)("div",{className:"jsx-8714994f2fc6f949 rush-hour-text",children:"RUSH HOUR"})}),(0,o.jsx)(r(),{id:"8714994f2fc6f949",children:'.top-bar.jsx-8714994f2fc6f949{position:fixed;top:20px;left:20px;display:flex;gap:16px;align-items:center;pointer-events:auto;z-index:100}.taxi-info.jsx-8714994f2fc6f949{font-size:24px;font-weight:bold;color:#fff;text-shadow:2px 2px 4px rgba(0,0,0,.8);font-family:monospace;background:rgba(0,0,0,.5);padding:8px 16px;border-radius:4px}.spawn-button.jsx-8714994f2fc6f949{font-size:18px;font-weight:bold;padding:8px 16px;background:#0f0;color:#000;border:none;border-radius:4px;cursor:pointer;font-family:monospace;transition:all.2s}.spawn-button.jsx-8714994f2fc6f949:hover{background:#0d0;transform:scale(1.05)}.spawn-button.jsx-8714994f2fc6f949:active{transform:scale(.95)}.spawn-button.jsx-8714994f2fc6f949:disabled{background:#666;color:#999;cursor:not-allowed;transform:none}.spawn-button.jsx-8714994f2fc6f949:disabled:hover{background:#666;transform:none}.pause-container.jsx-8714994f2fc6f949{position:fixed;top:20px;right:20px;pointer-events:auto;z-index:100}.pause-button.jsx-8714994f2fc6f949{font-size:24px;font-weight:bold;padding:10px 16px;background:rgba(255,255,255,.9);color:#000;border:2px solid#000;border-radius:8px;cursor:pointer;font-family:monospace;transition:all.2s;min-width:60px;height:50px;display:flex;align-items:center;justify-content:center}.pause-button.jsx-8714994f2fc6f949:hover{background:#fff;transform:scale(1.05)}.pause-button.jsx-8714994f2fc6f949:active{transform:scale(.95)}.timer-display.jsx-8714994f2fc6f949{position:fixed;bottom:20px;left:20px;font-size:32px;font-weight:bold;color:#fff;text-shadow:2px 2px 4px rgba(0,0,0,.8);font-family:monospace;pointer-events:none;z-index:100;padding:8px 16px;border-radius:4px;min-width:80px;text-align:center}.money-display.jsx-8714994f2fc6f949{position:fixed;bottom:20px;right:20px;font-size:32px;font-weight:bold;color:#ff0;text-shadow:2px 2px 4px rgba(0,0,0,.8);font-family:monospace;pointer-events:none;z-index:100}.rush-hour-banner.jsx-8714994f2fc6f949{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,#f00,#f80,#f00);padding:40px 80px;border-radius:20px;border:6px solid#ff0;box-shadow:0 0 40px rgba(255,0,0,.8),inset 0 0 20px rgba(255,255,0,.5);pointer-events:none;z-index:200;animation:rushHourPulse.5s ease-in-out infinite alternate,rushHourZoom.3s ease-out}.rush-hour-text.jsx-8714994f2fc6f949{font-size:80px;font-weight:bold;color:#fff;text-shadow:4px 4px 8px rgba(0,0,0,.9),0 0 20px#ff0,0 0 40px#f80;font-family:"Impact",monospace;letter-spacing:8px}@keyframes rushHourPulse{from{transform:translate(-50%,-50%)scale(1)}to{transform:translate(-50%,-50%)scale(1.05)}}@keyframes rushHourZoom{from{transform:translate(-50%,-50%)scale(.5);opacity:0}to{transform:translate(-50%,-50%)scale(1);opacity:1}}@media(max-width:768px){.top-bar.jsx-8714994f2fc6f949{top:10px;left:10px;gap:8px;flex-direction:column;align-items:flex-start}.taxi-info.jsx-8714994f2fc6f949{font-size:18px;padding:6px 12px}.spawn-button.jsx-8714994f2fc6f949{font-size:14px;padding:6px 12px}.pause-container.jsx-8714994f2fc6f949{top:10px;right:10px}.pause-button.jsx-8714994f2fc6f949{font-size:20px;padding:8px 12px;min-width:50px;height:40px}.timer-display.jsx-8714994f2fc6f949{bottom:10px;left:10px;font-size:24px;padding:6px 12px;min-width:60px}.money-display.jsx-8714994f2fc6f949{bottom:10px;right:10px;font-size:24px}.rush-hour-banner.jsx-8714994f2fc6f949{padding:20px 40px;border:4px solid#ff0}.rush-hour-text.jsx-8714994f2fc6f949{font-size:48px;letter-spacing:4px}}'})]})}function f(e){let{score:t,onRestart:n}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"jsx-2b318a3b15909e7c modal-overlay",children:(0,o.jsxs)("div",{className:"jsx-2b318a3b15909e7c modal-content",children:[(0,o.jsx)("h1",{className:"jsx-2b318a3b15909e7c title",children:"Game Over!"}),(0,o.jsxs)("div",{className:"jsx-2b318a3b15909e7c score-section",children:[(0,o.jsx)("div",{className:"jsx-2b318a3b15909e7c score-label",children:"Final Score"}),(0,o.jsxs)("div",{className:"jsx-2b318a3b15909e7c score-value",children:["$",t]})]}),(0,o.jsx)("button",{onClick:n,className:"jsx-2b318a3b15909e7c restart-button",children:"Play Again"})]})}),(0,o.jsx)(r(),{id:"2b318a3b15909e7c",children:".modal-overlay.jsx-2b318a3b15909e7c{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:1000;pointer-events:auto}.modal-content.jsx-2b318a3b15909e7c{background:#1a1a1a;border:4px solid#0f0;border-radius:8px;padding:48px 64px;display:flex;flex-direction:column;align-items:center;gap:32px;box-shadow:0 0 40px rgba(0,255,0,.3)}.title.jsx-2b318a3b15909e7c{font-size:48px;font-weight:bold;color:#0f0;margin:0;font-family:monospace;text-shadow:0 0 10px rgba(0,255,0,.5)}.score-section.jsx-2b318a3b15909e7c{display:flex;flex-direction:column;align-items:center;gap:8px}.score-label.jsx-2b318a3b15909e7c{font-size:24px;color:#fff;font-family:monospace}.score-value.jsx-2b318a3b15909e7c{font-size:64px;font-weight:bold;color:#ff0;font-family:monospace;text-shadow:0 0 10px rgba(255,255,0,.5)}.restart-button.jsx-2b318a3b15909e7c{font-size:24px;font-weight:bold;padding:16px 48px;background:#0f0;color:#000;border:none;border-radius:4px;cursor:pointer;font-family:monospace;transition:all.2s}.restart-button.jsx-2b318a3b15909e7c:hover{background:#0d0;transform:scale(1.05)}.restart-button.jsx-2b318a3b15909e7c:active{transform:scale(.95)}"})]})}let u=(0,s.default)(()=>Promise.all([n.e(367),n.e(413),n.e(937),n.e(256)]).then(n.bind(n,4256)),{loadableGenerated:{webpack:()=>[4256]},ssr:!1,loading:()=>(0,o.jsx)("div",{style:{width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#000",color:"#fff"},children:"Loading game..."})});function p(){let[e,t]=(0,i.useState)(!1),[n,a]=(0,i.useState)(0),[s,p]=(0,i.useState)(0),[x,h]=(0,i.useState)(!1),[g,m]=(0,i.useState)(!1),[b,j]=(0,i.useState)(!1),{taxisRef:w,deliveriesRef:v,pickupNodesRef:y,deliveryTimerRef:D,initialSpawnDoneRef:k}=function(){let e=(0,i.useRef)([{id:"taxi-1",state:"driving_to_pickup",path:(0,c.nt)().paths[0]||null,t:0,speed:1.5,isFocused:!1,currentIntersectionId:void 0,incomingDir:0,previousNodeId:void 0,hasPackage:!1,currentDeliveryId:void 0,money:100,isReversing:!1,collisionCooldown:0}]),t=(0,i.useRef)([]),n=(0,i.useRef)(1e4),o=(0,i.useRef)([]),a=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{let n=n=>{let{network:i}=n.detail;if(console.log("\uD83D\uDE95 Taxi received road network update:",i),i.paths.length>0&&e.current[0]){let t=i.paths.filter(e=>e.id.includes("Intersection")),n=t.length>0?t[0]:i.paths[0];e.current[0].path=n,e.current[0].t=0,console.log("✅ Taxi updated to starting path: ".concat(n.id)),console.log("   Available paths: ".concat(i.paths.length)),console.log("   Intersection paths: ".concat(t.length))}if(i.nodes){let e=i.nodes.filter(e=>e.types.includes("pickup"));if(o.current=e,console.log("\uD83D\uDCCD Found ".concat(e.length," pickup nodes")),e.length>=2&&!a.current){for(let n=0;n<3;n++){let n=(0,l.aK)(e,t.current);n&&t.current.push(n)}a.current=!0,console.log("\uD83C\uDFAE Spawned 3 initial deliveries")}}};return window.addEventListener("roadNetworkUpdated",n),()=>{window.removeEventListener("roadNetworkUpdated",n)}},[]),{taxisRef:e,deliveriesRef:t,pickupNodesRef:o,deliveryTimerRef:n,initialSpawnDoneRef:a}}(),N=(0,i.useCallback)(()=>{let e=w.current.reduce((e,t)=>e+t.money,0);if(!x&&e<10)return void console.log("❌ Not enough money to pause! Need $".concat(10,", have $").concat(e));!x&&w.current.length>0&&(w.current[0].money-=10,console.log("⏸️ Paused - Deducted $".concat(10))),h(!x)},[x,w]);return(0,i.useEffect)(()=>{let t=t=>{"h"===t.key.toLowerCase()?m(e=>!e):" "!==t.key||e||(t.preventDefault(),N())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,N]),(0,o.jsxs)("div",{className:"jsx-34ff5652e9ed6491 game-container",children:[(0,o.jsx)(u,{taxisRef:w,deliveriesRef:v,pickupNodesRef:y,deliveryTimerRef:D,isPaused:x,debugMode:g,isRushHour:b}),(0,o.jsxs)("div",{className:"jsx-34ff5652e9ed6491 ui-overlay",children:[(0,o.jsx)(d,{taxisRef:w,onGameOver:n=>{e||(a(n),t(!0))},isPaused:x,onTogglePause:N,onRushHourChange:e=>{j(e),console.log("\uD83D\uDEA6 RUSH HOUR ".concat(e?"ACTIVATED":"ENDED"))}}),g&&(0,o.jsx)("div",{className:"jsx-34ff5652e9ed6491 debug-indicator",children:"DEBUG MODE (Press D to toggle)"})]}),e&&(0,o.jsx)(f,{score:n,onRestart:()=>{w.current=[{id:"taxi-1",state:"driving_to_pickup",path:(0,c.nt)().paths[0]||null,t:0,speed:1.5,isFocused:!1,currentIntersectionId:void 0,incomingDir:0,previousNodeId:void 0,hasPackage:!1,currentDeliveryId:void 0,money:100,isReversing:!1,collisionCooldown:0}],v.current=[],D.current=1e4,k.current=!1,t(!1),a(0),j(!1),p(e=>e+1)}}),(0,o.jsx)(r(),{id:"34ff5652e9ed6491",children:".game-container.jsx-34ff5652e9ed6491{position:relative;width:100vw;height:100vh;overflow:hidden}.ui-overlay.jsx-34ff5652e9ed6491{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;display:flex;flex-direction:column;justify-content:flex-end;align-items:center;padding:2rem}.debug-indicator.jsx-34ff5652e9ed6491{position:fixed;top:70px;right:20px;background:rgba(255,0,0,.8);color:white;padding:8px 16px;border-radius:4px;font-family:monospace;font-size:14px;font-weight:bold;pointer-events:auto;z-index:100}@media(max-width:768px){.debug-indicator.jsx-34ff5652e9ed6491{top:60px;right:10px;font-size:12px;padding:6px 12px}}@media(max-width:480px){.debug-indicator.jsx-34ff5652e9ed6491{top:55px;right:10px;font-size:10px;padding:4px 8px}}"})]},s)}var x=n(5239);let h=[{image:"/tutorial_01.png",text:"Click intersections to control taxi routing. Green + for straight, blue ↶ for left, orange ↷ for right."},{image:"/tutorial_02.png",text:"Taxis automatically pick up colored packages and deliver them to matching colored destinations."},{image:"/tutorial_03.png",text:"Earn money from deliveries. Earn more tips for being timely. You have 120 seconds!"}];function g(){let[e,t]=(0,i.useState)(0);return(0,o.jsxs)("div",{className:"jsx-d48f836062ce2b2d tutorial-slider",children:[(0,o.jsxs)("div",{className:"jsx-d48f836062ce2b2d slider-content",children:[(0,o.jsx)("button",{onClick:()=>{t(e=>(e-1+h.length)%h.length)},className:"jsx-d48f836062ce2b2d arrow arrow-left",children:"‹"}),(0,o.jsxs)("div",{className:"jsx-d48f836062ce2b2d slide",children:[(0,o.jsx)("div",{className:"jsx-d48f836062ce2b2d slide-image",children:(0,o.jsx)(x.default,{src:h[e].image,alt:"Tutorial step ".concat(e+1),width:600,height:400,style:{objectFit:"contain"},priority:!0})}),(0,o.jsx)("p",{className:"jsx-d48f836062ce2b2d slide-text",children:h[e].text})]}),(0,o.jsx)("button",{onClick:()=>{t(e=>(e+1)%h.length)},className:"jsx-d48f836062ce2b2d arrow arrow-right",children:"›"})]}),(0,o.jsx)("div",{className:"jsx-d48f836062ce2b2d dots",children:h.map((n,i)=>(0,o.jsx)("button",{onClick:()=>{t(i)},"aria-label":"Go to slide ".concat(i+1),className:"jsx-d48f836062ce2b2d "+"dot ".concat(i===e?"active":"")},i))}),(0,o.jsx)(r(),{id:"d48f836062ce2b2d",children:".tutorial-slider.jsx-d48f836062ce2b2d{width:100%;max-width:700px;margin:2rem auto}.slider-content.jsx-d48f836062ce2b2d{display:flex;align-items:center;gap:1rem;position:relative}.arrow.jsx-d48f836062ce2b2d{background:rgba(255,255,255,.2);border:2px solid rgba(255,255,255,.5);color:white;font-size:3rem;width:50px;height:50px;border-radius:50%;cursor:pointer;transition:all.2s;display:flex;align-items:center;justify-content:center;padding:0;padding-bottom:4px;flex-shrink:0;line-height:0;font-family:Arial,sans-serif}.arrow.jsx-d48f836062ce2b2d:hover{background:rgba(255,255,255,.4);transform:scale(1.1)}.arrow.jsx-d48f836062ce2b2d:active{transform:scale(.95)}.slide.jsx-d48f836062ce2b2d{flex:1;text-align:center}.slide-image.jsx-d48f836062ce2b2d{background:rgba(0,0,0,.3);border-radius:8px;padding:1rem;margin-bottom:1rem;min-height:400px;display:flex;align-items:center;justify-content:center}.slide-text.jsx-d48f836062ce2b2d{color:white;font-size:1.1rem;line-height:1.6;margin:0;padding:0 2rem;text-shadow:2px 2px 4px rgba(0,0,0,.5)}.dots.jsx-d48f836062ce2b2d{display:flex;justify-content:center;gap:.75rem;margin-top:1.5rem}.dot.jsx-d48f836062ce2b2d{width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,.3);border:2px solid rgba(255,255,255,.5);cursor:pointer;transition:all.3s;padding:0}.dot.jsx-d48f836062ce2b2d:hover{background:rgba(255,255,255,.5);transform:scale(1.2)}.dot.active.jsx-d48f836062ce2b2d{background:#ff0;border-color:#ff6b00;transform:scale(1.3)}@media(max-width:768px){.tutorial-slider.jsx-d48f836062ce2b2d{max-width:90%}.slider-content.jsx-d48f836062ce2b2d{gap:.5rem}.arrow.jsx-d48f836062ce2b2d{font-size:2rem;width:40px;height:40px;line-height:0;padding-bottom:3px}.slide-image.jsx-d48f836062ce2b2d{min-height:250px;padding:.5rem}.slide-text.jsx-d48f836062ce2b2d{font-size:.95rem;padding:0 1rem}}@media(max-width:480px){.tutorial-slider.jsx-d48f836062ce2b2d{max-width:95%}.slider-content.jsx-d48f836062ce2b2d{gap:.25rem}.arrow.jsx-d48f836062ce2b2d{font-size:1.5rem;width:32px;height:32px;line-height:0;padding-bottom:2px}.slide-image.jsx-d48f836062ce2b2d{min-height:200px;padding:.25rem}.slide-text.jsx-d48f836062ce2b2d{font-size:.85rem;padding:0 .5rem}.dots.jsx-d48f836062ce2b2d{gap:.5rem;margin-top:1rem}.dot.jsx-d48f836062ce2b2d{width:10px;height:10px}}"})]})}function m(e){let{onPlay:t}=e;return(0,o.jsxs)("div",{className:"jsx-4a96cd54066b7650 intro-scene",children:[(0,o.jsxs)("div",{className:"jsx-4a96cd54066b7650 intro-content",children:[(0,o.jsx)("h1",{className:"jsx-4a96cd54066b7650 game-title",children:"Wayne Mo"}),(0,o.jsx)("p",{className:"jsx-4a96cd54066b7650 game-subtitle",children:"AI MANAGEMENT AUTOMATION"}),(0,o.jsxs)("div",{className:"jsx-4a96cd54066b7650 tutorial-section",children:[(0,o.jsx)("h2",{className:"jsx-4a96cd54066b7650 tutorial-title",children:"How to Play"}),(0,o.jsx)(g,{})]}),(0,o.jsx)("button",{onClick:t,className:"jsx-4a96cd54066b7650 play-button",children:"PLAY"}),(0,o.jsx)("div",{className:"jsx-4a96cd54066b7650 intro-hints",children:(0,o.jsx)("p",{className:"jsx-4a96cd54066b7650",children:"Command your autonomous taxi fleet"})})]}),(0,o.jsx)(r(),{id:"4a96cd54066b7650",children:".intro-scene.jsx-4a96cd54066b7650{position:fixed;top:0;left:0;width:100vw;height:100vh;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);display:flex;flex-direction:column;align-items:center;justify-content:flex-start;z-index:1000;overflow-y:auto;padding:2rem 1rem}.intro-content.jsx-4a96cd54066b7650{text-align:center;color:white;animation:fadeIn 1s ease-in;margin-bottom:2rem}.tutorial-section.jsx-4a96cd54066b7650{width:100%;max-width:800px;margin-top:2rem;animation:fadeIn 1.5s ease-in}.tutorial-title.jsx-4a96cd54066b7650{color:#ff0;font-size:2rem;font-weight:900;text-align:center;margin-bottom:1rem;text-shadow:2px 2px 4px rgba(0,0,0,.3);-webkit-text-stroke:1px#ff6b00}.game-title.jsx-4a96cd54066b7650{font-size:4rem;font-weight:900;letter-spacing:.2em;margin:0;text-shadow:4px 4px 8px rgba(0,0,0,.3);color:#ff0;-webkit-text-stroke:2px#ff6b00}.game-subtitle.jsx-4a96cd54066b7650{font-size:1.2rem;letter-spacing:.3em;margin:1rem 0 3rem;opacity:.9}.play-button.jsx-4a96cd54066b7650{background:#ff0;color:#000;border:4px solid#ff6b00;padding:1.5rem 4rem;font-size:2rem;font-weight:900;letter-spacing:.2em;cursor:pointer;transition:all.3s ease;box-shadow:0 8px 16px rgba(0,0,0,.3);border-radius:8px}.play-button.jsx-4a96cd54066b7650:hover{transform:translatey(-4px)scale(1.05);box-shadow:0 12px 24px rgba(0,0,0,.4);background:#fff200}.play-button.jsx-4a96cd54066b7650:active{transform:translatey(-2px)scale(1.02)}.intro-hints.jsx-4a96cd54066b7650{margin-top:3rem;opacity:.7}.intro-hints.jsx-4a96cd54066b7650 p.jsx-4a96cd54066b7650{margin:.5rem 0;font-size:1rem}@keyframes fadeIn{from{opacity:0;transform:translatey(20px)}to{opacity:1;transform:translatey(0)}}@media(max-width:768px){.intro-scene.jsx-4a96cd54066b7650{padding:1rem .5rem}.game-title.jsx-4a96cd54066b7650{font-size:2.5rem;letter-spacing:.1em}.game-subtitle.jsx-4a96cd54066b7650{font-size:.9rem;letter-spacing:.2em;margin:.5rem 0 2rem}.play-button.jsx-4a96cd54066b7650{padding:1rem 2rem;font-size:1.5rem;letter-spacing:.1em}.tutorial-title.jsx-4a96cd54066b7650{font-size:1.5rem}.intro-hints.jsx-4a96cd54066b7650{margin-top:2rem}.intro-hints.jsx-4a96cd54066b7650 p.jsx-4a96cd54066b7650{font-size:.9rem}}@media(max-width:480px){.game-title.jsx-4a96cd54066b7650{font-size:2rem}.game-subtitle.jsx-4a96cd54066b7650{font-size:.75rem;letter-spacing:.15em}.play-button.jsx-4a96cd54066b7650{padding:.75rem 1.5rem;font-size:1.25rem}.tutorial-title.jsx-4a96cd54066b7650{font-size:1.25rem}.tutorial-section.jsx-4a96cd54066b7650{max-width:95%}}"})]})}function b(){let[e,t]=(0,i.useState)(!1);return e?(0,o.jsx)(p,{}):(0,o.jsx)(m,{onPlay:()=>t(!0)})}},4510:(e,t,n)=>{"use strict";n.d(t,{E$:()=>a,KQ:()=>r,ac:()=>s});var o=n(5339),i=n(8946);function a(e,t,n){if("stopped"===e.state||!e.path)return;let o=t*e.speed/e.path.length;e.isReversing?(e.t-=o,e.t<=0&&(e.t=0,e.isReversing=!1,console.log("✅ ".concat(e.id," finished reversing, back at start of path")),function(e,t){if(!e.path)return;let n=e.path.id,o=n.split("_to_");if(2!==o.length)return console.warn("⚠️ Invalid path ID format: ".concat(n));let a=o[0],r=o[1],s="".concat(r,"_to_").concat(a);console.log("\uD83D\uDD04 ".concat(e.id," at ").concat(a,", routing from here (was reversing on ").concat(n,")"));let c=(0,i.D3)(s,t,e);c?(console.log("\uD83D\uDE95 Post-reversal transition: ".concat(a," → ").concat(c.id)),e.path=c,e.t=0):console.warn("⚠️ No next path found from ".concat(a," after reversal"))}(e,n))):(e.t+=o,e.t>=1&&(e.t=1,function(e,t){if(!e.path)return;let n=e.path.id,o=n.split("_to_");2===o.length&&(e.previousNodeId=o[0]);let a=(0,i.D3)(n,t,e);a?(console.log("\uD83D\uDE95 Path transition: ".concat(n," → ").concat(a.id)),e.path=a,e.t=0):console.warn("⚠️ No next path found for ".concat(n))}(e,n)))}function r(e,t){if(0===e.points.length)return new o.Pq0;if(1===e.points.length)return e.points[0].clone();let n=Math.max(0,Math.min(1,t)),i=Math.floor(n*(e.points.length-1)),a=Math.min(i+1,e.points.length-1),r=n*(e.points.length-1)%1;return e.points[i].clone().lerp(e.points[a],r)}function s(e){let t=0;for(let n=0;n<e.length-1;n++)t+=e[n].distanceTo(e[n+1]);return t}},8164:(e,t,n)=>{Promise.resolve().then(n.bind(n,127))},8774:(e,t,n)=>{"use strict";n.d(t,{WF:()=>s,aK:()=>a});var o=n(5339);let i=["#00ff00","#0088ff","#ff00ff","#ffff00","#ff8800","#00ffff","#ff0088","#88ff00","#ff0000","#8800ff","#00ff88","#ff8888","#88ff88","#8888ff","#ffff88","#ff88ff"];function a(e){var t,n;let o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.length<2)return console.warn("⚠️ Not enough pickup nodes to spawn delivery"),null;let r=new Set;a.forEach(e=>{"waiting_pickup"===e.status&&r.add(e.pickupNodeId),"in_transit"===e.status&&r.add(e.dropoffNodeId)});let s=e.filter(e=>!r.has(e.id));if(s.length<2)return console.warn("⚠️ Not enough available pickup nodes (all nodes in use)"),null;let c=s[Math.floor(Math.random()*s.length)];do o=s[Math.floor(Math.random()*s.length)];while(o.id===c.id);let l=c.position.distanceTo(o.position),d=Math.floor((((null==(t=c.metadata)?void 0:t.payoutMultiplier)||1)+((null==(n=o.metadata)?void 0:n.payoutMultiplier)||1))/2*(100+10*l)),f=new Set(a.map(e=>e.color)),u=i.filter(e=>!f.has(e)),p=u.length>0?u:i,x=p[Math.floor(Math.random()*p.length)],h={id:"delivery-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),pickupNodeId:c.id,dropoffNodeId:o.id,status:"waiting_pickup",spawnTime:Date.now(),payout:d,color:x};return console.log("\uD83D\uDCE6 Spawned delivery: ".concat(c.id," → ").concat(o.id," ($").concat(d,") [").concat(x,"]")),h}function r(e,t,n){for(let o of t.filter(e=>"waiting_pickup"===e.status)){let t=n.find(e=>e.id===o.pickupNodeId);if(t&&1.1>e.distanceTo(t.position))return{event:o,node:t}}return null}function s(e,t,n){let i=[];for(let s of e){if(!s.path)continue;let e=s.path.points;if(e.length<2)continue;let c=1/(e.length-1),l=Math.floor(s.t/c),d=s.t%c/c,f=e[Math.min(l,e.length-2)],u=e[Math.min(l+1,e.length-1)],p=new o.Pq0().lerpVectors(f,u,d);if(s.hasPackage){let e=r(p,t,n);e&&.1>Math.random()&&console.log("\uD83D\uDEAB ".concat(s.id," ignoring pickup ").concat(e.event.id," (already carrying ").concat(s.currentDeliveryId,")"))}else{var a;let e=r(p,t,n);e&&(a=e.event,s.hasPackage=!0,s.currentDeliveryId=a.id,a.status="in_transit",a.claimedByTaxiId=s.id,a.pickupTime=Date.now(),console.log("\uD83D\uDE95 ".concat(s.id," picked up ").concat(a.id," at ").concat(a.pickupNodeId)))}if(s.currentDeliveryId){let e=function(e,t,n,o){let i=n.find(e=>e.id===t&&"in_transit"===e.status);if(!i)return null;let a=o.find(e=>e.id===i.dropoffNodeId);return a&&1.1>e.distanceTo(a.position)?{event:i,node:a}:null}(p,s.currentDeliveryId,t,n);e&&(!function(e,t){e.hasPackage=!1,e.currentDeliveryId=void 0,e.money+=t.payout,t.status="completed",t.deliveryTime=Date.now();let n=((t.deliveryTime-t.spawnTime)/1e3).toFixed(1);console.log("✅ ".concat(e.id," completed ").concat(t.id," at ").concat(t.dropoffNodeId," (+$").concat(t.payout,") in ").concat(n,"s")),t.payout}(s,e.event),i.push(e.event.id))}}return i}},8946:(e,t,n)=>{"use strict";n.d(t,{D3:()=>g,nt:()=>h,WW:()=>x});var o=n(5339),i=n(4510);function a(e){return["North","East","South","West"][e]}let r=[new o.Pq0(-15,.2,-15),new o.Pq0(-15,.2,-5),new o.Pq0(-15,.2,5),new o.Pq0(-15,.2,15)],s=[new o.Pq0(-15,.2,15),new o.Pq0(-5,.2,15),new o.Pq0(5,.2,15),new o.Pq0(15,.2,15)],c=[new o.Pq0(15,.2,15),new o.Pq0(15,.2,5),new o.Pq0(15,.2,-5),new o.Pq0(15,.2,-15)],l=[new o.Pq0(15,.2,-15),new o.Pq0(5,.2,-15),new o.Pq0(-5,.2,-15),new o.Pq0(-15,.2,-15)],d={id:"path-1",points:r,length:(0,i.ac)(r)},f={id:"path-2",points:s,length:(0,i.ac)(s)},u={id:"path-3",points:c,length:(0,i.ac)(c)},p={paths:[d,f,u,{id:"path-4",points:l,length:(0,i.ac)(l)}],nodes:[{id:"node-1",position:new o.Pq0(-15,.2,-15),neighbors:["node-2","node-4",null,null],types:["intersection"]},{id:"node-2",position:new o.Pq0(-15,.2,15),neighbors:[null,"node-3","node-1",null],types:["intersection","pickup"],metadata:{zoneName:"North Terminal",payoutMultiplier:1.2}},{id:"node-3",position:new o.Pq0(15,.2,15),neighbors:[null,null,"node-4","node-2"],types:["intersection","red_light"],metadata:{redLightDuration:3,greenLightDuration:5,currentState:"green"}},{id:"node-4",position:new o.Pq0(15,.2,-15),neighbors:["node-3",null,null,"node-1"],types:["intersection","dropoff"],metadata:{zoneName:"Downtown",payoutMultiplier:1}}]};function x(e){console.log("\uD83D\uDEE3️ Updating road network with ".concat(e.length," extracted nodes"));let t=[],n=new Set;return e.forEach(o=>{let a=[];o.neighbors?(a=o.neighbors.filter(e=>null!==e),console.log("  ".concat(o.id,": topological format, ").concat(a.length," neighbors"))):o.next&&(a=o.next,console.log("  ".concat(o.id,": legacy format, ").concat(a.length," next nodes"))),a.forEach(a=>{let r="".concat(o.id,"_to_").concat(a);if(n.has(r))return;let s=e.find(e=>e.id===a);if(!s)return void console.warn("⚠️ Node ".concat(a," referenced by ").concat(o.id," not found"));let c=[o.position.clone(),s.position.clone()];t.push({id:r,points:c,length:(0,i.ac)(c)}),n.add(r),console.log("  ✅ Created path: ".concat(r))})}),p={nodes:e,paths:t},console.log("✅ Road network updated: ".concat(e.length," nodes, ").concat(t.length," paths")),console.log("\uD83D\uDCCA Network Graph:"),e.forEach(e=>{e.neighbors?console.log("  ".concat(e.id," [TOPO] → N:").concat(e.neighbors[0]||"-",", E:").concat(e.neighbors[1]||"-",", S:").concat(e.neighbors[2]||"-",", W:").concat(e.neighbors[3]||"-")):e.next&&console.log("  ".concat(e.id," [LEGACY] → [").concat(e.next.join(", "),"]"))}),console.log("\uD83D\uDEE3️ Generated Paths:"),t.forEach(e=>{console.log("  ".concat(e.id," (").concat(e.length.toFixed(2)," units)"))}),p}function h(){return p}function g(e,t,n){let i=p.paths,r=p.nodes,s=e.split("_to_");if(2!==s.length)return console.warn("⚠️ Invalid path ID format: ".concat(e)),null;let c=s[0],l=s[1],d=r.find(e=>e.id===l);if(!d)return console.warn("⚠️ Destination node ".concat(l," not found")),null;if(d.neighbors&&n){var f;let e;for(let t=0;t<4;t++)if(d.neighbors[t]===c){e=t;break}void 0===e&&console.warn("⚠️ Could not calculate incomingDir for ".concat(c," → ").concat(l,", using fallback"));let o=null!=(f=null!=e?e:n.incomingDir)?f:0,r=d.types.includes("intersection")?null==t?void 0:t.get(l):void 0,s=(null==r?void 0:r.mode)||"pass_through",u=function(e,t,n){if(!e.neighbors||4!==e.neighbors.length)return console.warn("⚠️ Node ".concat(e.id," is not a valid intersection (no neighbors array)")),{nextId:null,outgoingDir:null};let o=e.neighbors.filter(e=>null!==e).length;if(1===o){let n=e.neighbors[t];if(n)return console.log("⚠️ ".concat(e.id,": Dead end, U-turn back → ").concat(n)),{nextId:n,outgoingDir:t}}if(2===o)for(let n=0;n<4;n++){let o=n;if(o!==t&&null!==e.neighbors[o]){let n=e.neighbors[o];return console.log("\uD83D\uDD04 ".concat(e.id,": Corner, Incoming ").concat(a(t)," → ").concat(a(o)," → ").concat(n)),{nextId:n,outgoingDir:o}}}for(let o of function(e,t){if(2===e)switch(t){case"pass_through":return[0,1,2,3];case"turn_right":return[1,2,3,0];case"turn_left":return[3,2,1,0]}else if(0===e)switch(t){case"pass_through":return[2,3,0,1];case"turn_right":return[3,0,1,2];case"turn_left":return[1,0,3,2]}else if(3===e)switch(t){case"pass_through":return[1,2,3,0];case"turn_right":return[2,3,0,1];case"turn_left":return[0,3,2,1]}else switch(t){case"pass_through":return[3,0,1,2];case"turn_right":return[0,1,2,3];case"turn_left":return[2,1,0,3]}}(t,n)){if(o===t)continue;let i=e.neighbors[o];if(null!==i)return console.log("✅ ".concat(e.id,": Incoming ").concat(a(t),", Mode ").concat(n,", Chose ").concat(a(o)," → ").concat(i)),{nextId:i,outgoingDir:o}}return console.warn("⚠️ ".concat(e.id,": No available path from ").concat(a(t)," with mode ").concat(n)),{nextId:null,outgoingDir:null}}(d,o,s);if(!u.nextId||null===u.outgoingDir)return console.warn("⚠️ No available route from ".concat(l)),null;{let e=i.find(e=>e.id==="".concat(l,"_to_").concat(u.nextId));if(!e)return console.warn("⚠️ Path ".concat(l,"_to_").concat(u.nextId," not found in network")),null;{let t=(u.outgoingDir+2)%4;return n.currentIntersectionId=l,n.incomingDir=t,console.log("\uD83D\uDEA6 ".concat(l,": Mode ").concat(s,", In ").concat(a(o)," → Out ").concat(a(u.outgoingDir)," → ").concat(u.nextId)),e}}}let u=i.filter(e=>e.id.startsWith("".concat(l,"_to_")));if(0===u.length)return console.warn("⚠️ No next path found from node: ".concat(l)),null;if(1===u.length)return u[0];if(d.types.includes("intersection")&&t){let n=t.get(l);if(n){let t=function(e,t,n){let i=n.filter(e=>e.id.startsWith("".concat(t.id,"_to_"))),a=n.find(t=>t.id===e);if(!a)return console.warn("⚠️ Incoming path ".concat(e," not found")),{straight:null,left:null,right:null};if(1===i.length)return{straight:i[0].id,left:null,right:null};let r={straight:null,left:null,right:null};return i.forEach(e=>{let n=function(e,t,n){let i=new o.Pq0().subVectors(e.points[e.points.length-1],e.points[e.points.length-2]).normalize(),a=new o.Pq0().subVectors(n.points[1],n.points[0]).normalize(),r=new o.Pq0().crossVectors(i,a);return i.dot(a)>.8?"straight":r.y>.1?"left":r.y<-.1?"right":"straight"}(a,0,e);r[n]?console.warn('⚠️ Multiple paths detected as "'.concat(n,'" at ').concat(t.id)):r[n]=e.id}),console.log("\uD83D\uDCCD Path categorization at ".concat(t.id,":"),{incoming:e,straight:r.straight,left:r.left,right:r.right}),r}(e,d,i),a=null;switch(n.mode){case"pass_through":a=t.straight;break;case"turn_left":a=t.left;break;case"turn_right":a=t.right}if(a){let e=i.find(e=>e.id===a);if(e)return console.log("\uD83D\uDEA6 Path-based routing at ".concat(l,": ").concat(n.mode," → ").concat(a)),e}if(t.straight){let e=i.find(e=>e.id===t.straight);if(e)return console.warn("⚠️ Intersection ".concat(l,': mode "').concat(n.mode,'" not available, using straight')),e}}}let x=Math.floor(Math.random()*u.length);return console.log("\uD83C\uDFB2 Random path selection at ".concat(l,": ").concat(u[x].id)),u[x]}}},e=>{e.O(0,[831,795,441,255,358],()=>e(e.s=8164)),_N_E=e.O()}]);
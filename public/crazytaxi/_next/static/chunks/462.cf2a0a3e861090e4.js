(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{2462:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>k});var n=i(5155),s=i(2115),l=i(5921),a=i(3511),o=i(7909),r=i(8774),c=i(4476),u=i(3381),d=i.n(u),p=i(8615),h=i.n(p),x=i(9135),v=i.n(x),f=i(6620),m=i.n(f);let y=(0,o.default)(()=>Promise.all([i.e(687),i.e(443),i.e(506)]).then(i.bind(i,506)),{loadableGenerated:{webpack:()=>[506]},ssr:!1});function k(e){var t;let{onComplete:i}=e,[o,u]=(0,s.useState)(0),[p,x]=(0,s.useState)("tutorial-taxi-1"),[f,k]=(0,s.useState)(!1),[w,_]=(0,s.useState)(!0),{taxisRef:g,deliveriesRef:T,pickupNodesRef:b,deliveryTimerRef:N}=function(){let e=(0,s.useRef)([{id:"tutorial-taxi-1",state:"driving_to_pickup",path:null,t:0,speed:1.5,isFocused:!1,currentIntersectionId:void 0,incomingDir:0,previousNodeId:void 0,hasPackage:!1,currentDeliveryId:void 0,money:0,isReversing:!1,collisionCooldown:0,isReady:!1}]),t=(0,s.useRef)([]),i=(0,s.useRef)(1e4),n=(0,s.useRef)([]),l=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{let i=i=>{let{network:s}=i.detail;if(console.log("\uD83D\uDCDA Tutorial received road network update:",s),s.paths.length>0&&e.current[0]){let t=s.paths[0];e.current[0].path=t,e.current[0].t=0,e.current[0].isReady=!0,console.log("âœ… Tutorial taxi on path: ".concat(t.id)),console.log("   Total paths: ".concat(s.paths.length))}if(s.nodes){let e=s.nodes.filter(e=>e.types.includes("pickup"));if(n.current=e,console.log("\uD83D\uDCCD Tutorial has ".concat(e.length," pickup nodes")),e.length>=2&&!l.current){for(let i=0;i<2;i++){let i=(0,r.aK)(e,t.current);i&&t.current.push(i)}l.current=!0,console.log("\uD83C\uDFAE Tutorial spawned 2 initial deliveries")}}};return window.addEventListener("roadNetworkUpdated",i),()=>{window.removeEventListener("roadNetworkUpdated",i)}},[]),{taxisRef:e,deliveriesRef:t,pickupNodesRef:n,deliveryTimerRef:i}}(),j=[{title:"Yo, what up. First day?",description:"It's easy. The taxis will stay on the road, you just gotta direct them to the biggest packages."},{title:"Plus the controls are pretty chill...",description:"Tap an intersection to set the vibe. The next cab that rolls through will know what to do."},{title:"'notha day another dolla aye Benjamin?",description:"Once you got a box that cabs underglow will match the dropoff rings. Keep those lines clean."}],C=j[o],R=(0,s.useCallback)(e=>{x(t=>t===e?null:e)},[]),D=(0,s.useCallback)(()=>{x(null)},[]),S=(0,s.useCallback)(()=>{k(e=>!e)},[]);return(0,s.useEffect)(()=>{let e=e=>{" "===e.key&&(e.preventDefault(),S())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[S]),(0,n.jsxs)("div",{className:m().tutorialContainer,children:[(0,n.jsx)(y,{taxisRef:g,deliveriesRef:T,pickupNodesRef:b,deliveryTimerRef:N,followTaxiId:p,isPaused:f}),(0,n.jsxs)("div",{className:m().tutorialOverlay,children:[(0,n.jsx)(c.l,{taxisRef:g,onTaxiSelect:R,onResetCamera:D,selectedTaxiId:p}),(0,n.jsxs)("div",{className:v().topLeft,style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,n.jsx)("button",{className:d().primary,onClick:()=>{i()},children:"Start Game"}),!w&&(0,n.jsx)("button",{className:d().secondary,onClick:()=>{_(!0)},children:"Show Tutorial"})]}),(0,n.jsx)("div",{className:v().bottomRight,children:(0,n.jsx)("button",{className:d().icon,onClick:S,children:f?(0,n.jsx)(l.A,{size:24}):(0,n.jsx)(a.A,{size:24})})}),(0,n.jsxs)("div",{className:h().moneyDisplay,children:["$",(null==(t=g.current[0])?void 0:t.money)||0]}),w&&(0,n.jsxs)("div",{className:m().instructionPanel,children:[(0,n.jsx)("h2",{className:m().stepTitle,children:C.title}),(0,n.jsx)("p",{className:m().stepDescription,children:C.description}),(0,n.jsxs)("div",{className:m().buttonGroup,children:[o>0&&(0,n.jsx)("button",{className:d().secondary,onClick:()=>{o>0&&u(o-1)},children:"Previous"}),(0,n.jsx)("button",{className:d().primary,onClick:()=>{o<j.length-1?u(o+1):_(!1)},children:o<j.length-1?"Next":"Play Tutorial"})]})]})]})]})}},6620:e=>{e.exports={tutorialContainer:"TutorialScene_tutorialContainer__JYRcU",tutorialOverlay:"TutorialScene_tutorialOverlay__Ur0l0",instructionPanel:"TutorialScene_instructionPanel__kcusO",stepTitle:"TutorialScene_stepTitle__EZ_Op",stepDescription:"TutorialScene_stepDescription__V1U_R",buttonGroup:"TutorialScene_buttonGroup__6nSDN"}}}]);
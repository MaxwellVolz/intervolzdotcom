"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{421:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var r=n(5155),i=n(2115),o=n(5339),s=n(9980),a=n(258),l=n(4068),u=n(3975),c=n(3531),p=n(8148),m=n(3946);let f=(0,i.forwardRef)(function(e,t){let{initialAnimation:n,...a}=e,l=(0,i.useRef)(null),{scene:u,animations:f}=(0,c.p)((0,m.O)("models/maxwell.glb")),d=i.useMemo(()=>p.t.clone(u),[u]),{nodes:h,materials:v}=(0,s.F)(d),{actions:x}=function(e,t){let n=i.useRef(null),[r]=i.useState(()=>t?t instanceof o.B69?{current:t}:t:n),[a]=i.useState(()=>new o.Iw4(void 0));i.useLayoutEffect(()=>{t&&(r.current=t instanceof o.B69?t:t.current),a._root=r.current});let l=i.useRef({}),u=i.useMemo(()=>{let t={};return e.forEach(e=>Object.defineProperty(t,e.name,{enumerable:!0,get(){if(r.current)return l.current[e.name]||(l.current[e.name]=a.clipAction(e,r.current))},configurable:!0})),{ref:r,clips:e,actions:t,names:e.map(e=>e.name),mixer:a}},[e]);return(0,s.D)((e,t)=>a.update(t)),i.useEffect(()=>{let e=r.current;return()=>{l.current={},a.stopAllAction(),Object.values(u.actions).forEach(t=>{e&&a.uncacheAction(t,e)})}},[e]),u}(f,l),M=(0,i.useRef)(null),y=(0,i.useRef)(!1);return(0,i.useImperativeHandle)(t,()=>({playAnimation:e=>{if(null===e){M.current&&(M.current.fadeOut(.3),M.current=null);return}let t=x[e];t&&(t.reset(),t.setEffectiveTimeScale(1),t.setEffectiveWeight(1),t.play(),M.current&&M.current!==t&&t.crossFadeFrom(M.current,.3,!0),M.current=t)}})),(0,i.useEffect)(()=>{if(n&&x[n]&&!y.current){y.current=!0;let e=x[n];e.reset(),e.setEffectiveTimeScale(1),e.setEffectiveWeight(1),e.play(),M.current=e}},[n,x]),(0,i.useEffect)(()=>()=>{M.current&&M.current.stop()},[]),(0,r.jsx)("group",{ref:l,...a,dispose:null,children:(0,r.jsx)("group",{name:"Scene",children:(0,r.jsxs)("group",{name:"maxwell_armature",position:[-1.475,7.593,1.854],rotation:[Math.PI/2,0,-3.086],scale:5e-5,userData:{name:"maxwell_armature"},children:[(0,r.jsx)("primitive",{object:h.mixamorigHips}),(0,r.jsx)("skinnedMesh",{name:"max_model",geometry:h.max_model.geometry,material:v.PolygonOffice_Charaters,skeleton:h.max_model.skeleton,userData:{name:"max_model"}})]})})})});function d(e){let{lookAt:t,initialFov:n}=e,{camera:r,gl:a}=(0,s.C)(),l=(0,i.useRef)(!1),u=(0,i.useRef)(0),c=(0,i.useRef)(0),p=(0,i.useRef)(n),m=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{if(!m.current){r.lookAt(t[0],t[1],t[2]);let e=new o.O9p().setFromQuaternion(r.quaternion,"YXZ");u.current=e.y,c.current=e.x,p.current=n,m.current=!0}},[r,t,n]),(0,i.useEffect)(()=>{let e=a.domElement,t=0,n=()=>{l.current=!0},r=()=>{l.current=!1},i=e=>{l.current&&(u.current-=.002*e.movementX,c.current-=.002*e.movementY,c.current=Math.max(-Math.PI/2.5,Math.min(Math.PI/2.5,c.current)))},o=e=>{e.preventDefault(),p.current+=.05*e.deltaY,p.current=Math.max(20,Math.min(120,p.current))},s=e=>{if(2===e.touches.length){let n=e.touches[0].clientX-e.touches[1].clientX,r=e.touches[0].clientY-e.touches[1].clientY;t=Math.sqrt(n*n+r*r)}},m=e=>{if(2===e.touches.length){e.preventDefault();let n=e.touches[0].clientX-e.touches[1].clientX,r=e.touches[0].clientY-e.touches[1].clientY,i=Math.sqrt(n*n+r*r),o=t-i;p.current+=.1*o,p.current=Math.max(20,Math.min(120,p.current)),t=i}else l.current&&e.preventDefault()};return e.addEventListener("pointerdown",n),e.addEventListener("pointerup",r),e.addEventListener("pointermove",i),e.addEventListener("wheel",o,{passive:!1}),e.addEventListener("touchstart",s,{passive:!1}),e.addEventListener("touchmove",m,{passive:!1}),()=>{e.removeEventListener("pointerdown",n),e.removeEventListener("pointerup",r),e.removeEventListener("pointermove",i),e.removeEventListener("wheel",o),e.removeEventListener("touchstart",s),e.removeEventListener("touchmove",m)}},[a]),(0,s.D)(()=>{let e=new o.PTz,t=new o.O9p(c.current,u.current,0,"YXZ");e.setFromEuler(t),r.quaternion.copy(e),"fov"in r&&(r.fov=p.current,r.updateProjectionMatrix())}),null}function h(e){let{characterRef:t,initialAnimation:n}=e;return(0,r.jsxs)(a.Hl,{camera:{position:[-1.5,8.24,1],fov:90,near:.01,far:100},style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:[(0,r.jsx)(d,{lookAt:[-1.5,8.25,1.5],initialFov:90}),(0,r.jsx)("ambientLight",{intensity:.4}),(0,r.jsx)("directionalLight",{position:[5,5,5],intensity:.8,castShadow:!0}),(0,r.jsx)("pointLight",{position:[-3.5,1.5,11],intensity:.5,color:"#ffaa55"}),(0,r.jsx)(l.t,{fogDensity:.02,showSky:!0,showStars:!0}),(0,r.jsx)(i.Suspense,{fallback:null,children:(0,r.jsx)(u.K,{})}),(0,r.jsx)(i.Suspense,{fallback:null,children:(0,r.jsx)(f,{ref:t,initialAnimation:n})})]})}c.p.preload((0,m.O)("models/maxwell.glb"))},8148:(e,t,n)=>{n.d(t,{t:()=>a});var r=n(5339);function i(e,t,n={}){let a,l,u,c,p,m=new r.Pq0,f=new r.PTz,d=new r.Pq0,h=new r.kn4,v=new r.kn4,x=new r.kn4;n.preserveMatrix=void 0===n.preserveMatrix||n.preserveMatrix,n.preservePosition=void 0===n.preservePosition||n.preservePosition,n.preserveHipPosition=void 0!==n.preserveHipPosition&&n.preserveHipPosition,n.useTargetMatrix=void 0!==n.useTargetMatrix&&n.useTargetMatrix,n.hip=void 0!==n.hip?n.hip:"hip",n.names=n.names||{};let M=t.isObject3D?t.skeleton.bones:s(t),y=e.isObject3D?e.skeleton.bones:s(e);if(e.isObject3D?e.skeleton.pose():(n.useTargetMatrix=!0,n.preserveMatrix=!1),n.preservePosition){p=[];for(let e=0;e<y.length;e++)p.push(y[e].position.clone())}if(n.preserveMatrix){e.updateMatrixWorld(),e.matrixWorld.identity();for(let t=0;t<e.children.length;++t)e.children[t].updateMatrixWorld(!0)}if(n.offsets){a=[];for(let e=0;e<y.length;++e)l=y[e],u=n.names[l.name]||l.name,n.offsets[u]&&(l.matrix.multiply(n.offsets[u]),l.matrix.decompose(l.position,l.quaternion,l.scale),l.updateMatrixWorld()),a.push(l.matrixWorld.clone())}for(let t=0;t<y.length;++t){if(l=y[t],c=o(u=n.names[l.name]||l.name,M),x.copy(l.matrixWorld),c){if(c.updateMatrixWorld(),n.useTargetMatrix?v.copy(c.matrixWorld):(v.copy(e.matrixWorld).invert(),v.multiply(c.matrixWorld)),d.setFromMatrixScale(v),v.scale(d.set(1/d.x,1/d.y,1/d.z)),x.makeRotationFromQuaternion(f.setFromRotationMatrix(v)),e.isObject3D){let t=y.indexOf(l),n=a?a[t]:h.copy(e.skeleton.boneInverses[t]).invert();x.multiply(n)}x.copyPosition(v)}l.parent&&l.parent.isBone?(l.matrix.copy(l.parent.matrixWorld).invert(),l.matrix.multiply(x)):l.matrix.copy(x),n.preserveHipPosition&&u===n.hip&&l.matrix.setPosition(m.set(0,l.position.y,0)),l.matrix.decompose(l.position,l.quaternion,l.scale),l.updateMatrixWorld()}if(n.preservePosition)for(let e=0;e<y.length;++e)l=y[e],(u=n.names[l.name]||l.name)!==n.hip&&l.position.copy(p[e]);n.preserveMatrix&&e.updateMatrixWorld(!0)}function o(e,t){for(let n=0,r=s(t);n<r.length;n++)if(e===r[n].name)return r[n]}function s(e){return Array.isArray(e)?e:e.bones}let a={retarget:i,retargetClip:function(e,t,n,a={}){let l,u,c,p;a.useFirstFramePosition=void 0!==a.useFirstFramePosition&&a.useFirstFramePosition,a.fps=void 0!==a.fps?a.fps:30,a.names=a.names||[],t.isObject3D||(t=function(e){let t=new r._xc(e.bones[0]);return t.skeleton=e,t}(t));let m=Math.round(n.duration*(a.fps/1e3)*1e3),f=1/a.fps,d=[],h=new r.Iw4(t),v=s(e.skeleton),x=[];h.clipAction(n).play(),h.update(0),t.updateMatrixWorld();for(let n=0;n<m;++n){let r=n*f;i(e,t,a);for(let e=0;e<v.length;++e)o(p=a.names[v[e].name]||v[e].name,t.skeleton)&&(u=v[e],c=x[e]=x[e]||{bone:u},a.hip===p&&(c.pos||(c.pos={times:new Float32Array(m),values:new Float32Array(3*m)}),a.useFirstFramePosition&&(0===n&&(l=u.position.clone()),u.position.sub(l)),c.pos.times[n]=r,u.position.toArray(c.pos.values,3*n)),c.quat||(c.quat={times:new Float32Array(m),values:new Float32Array(4*m)}),c.quat.times[n]=r,u.quaternion.toArray(c.quat.values,4*n));h.update(f),t.updateMatrixWorld()}for(let e=0;e<x.length;++e)(c=x[e])&&(c.pos&&d.push(new r.RiT(".bones["+c.bone.name+"].position",c.pos.times,c.pos.values)),d.push(new r.MBL(".bones["+c.bone.name+"].quaternion",c.quat.times,c.quat.values)));return h.uncacheAction(n),new r.tz3(n.name,-1,d)},clone:function(e){let t=new Map,n=new Map,r=e.clone();return function e(t,n,r){r(t,n);for(let i=0;i<t.children.length;i++)e(t.children[i],n.children[i],r)}(e,r,function(e,r){t.set(r,e),n.set(e,r)}),r.traverse(function(e){if(!e.isSkinnedMesh)return;let r=t.get(e),i=r.skeleton.bones;e.skeleton=r.skeleton.clone(),e.bindMatrix.copy(r.bindMatrix),e.skeleton.bones=i.map(function(e){return n.get(e)}),e.bind(e.skeleton,e.bindMatrix)}),r}}}}]);
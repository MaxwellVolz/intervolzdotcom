(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{2462:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>_});var n=i(5155),s=i(2115),o=i(5921),a=i(3511),l=i(7909),r=i(8774),c=i(2077),u=i(3381),d=i.n(u),p=i(8615),h=i.n(p),f=i(9135),v=i.n(f),m=i(6620),x=i.n(m);let k=(0,l.default)(()=>Promise.all([i.e(367),i.e(413),i.e(268),i.e(443),i.e(506)]).then(i.bind(i,506)),{loadableGenerated:{webpack:()=>[506]},ssr:!1});function _(e){var t;let{onComplete:i}=e,[l,u]=(0,s.useState)(0),[p,f]=(0,s.useState)("tutorial-taxi-1"),[m,_]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!0),{taxisRef:g,deliveriesRef:w,pickupNodesRef:N,deliveryTimerRef:T}=function(){let e=(0,s.useRef)([{id:"tutorial-taxi-1",state:"driving_to_pickup",path:null,t:0,speed:1.5,isFocused:!1,currentIntersectionId:void 0,incomingDir:0,previousNodeId:void 0,hasPackage:!1,currentDeliveryId:void 0,money:0,isReversing:!1,collisionCooldown:0}]),t=(0,s.useRef)([]),i=(0,s.useRef)(1e4),n=(0,s.useRef)([]),o=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{let i=i=>{let{network:s}=i.detail;if(console.log("\uD83D\uDCDA Tutorial received road network update:",s),s.paths.length>0&&e.current[0]){let t=s.paths[0];e.current[0].path=t,e.current[0].t=0,console.log("âœ… Tutorial taxi on path: ".concat(t.id)),console.log("   Total paths: ".concat(s.paths.length))}if(s.nodes){let e=s.nodes.filter(e=>e.types.includes("pickup"));if(n.current=e,console.log("\uD83D\uDCCD Tutorial has ".concat(e.length," pickup nodes")),e.length>=2&&!o.current){for(let i=0;i<2;i++){let i=(0,r.aK)(e,t.current);i&&t.current.push(i)}o.current=!0,console.log("\uD83C\uDFAE Tutorial spawned 2 initial deliveries")}}};return window.addEventListener("roadNetworkUpdated",i),()=>{window.removeEventListener("roadNetworkUpdated",i)}},[]),{taxisRef:e,deliveriesRef:t,pickupNodesRef:n,deliveryTimerRef:i}}(),C=[{title:"Controls Cameras Cabs",description:"Bottom left buttons set chase camera, overview, and you can buy another cab if you got the cash..."},{title:"Run the Intersections",description:"Tap intersections to direct traffic! Try to avoid collisions."},{title:"Deliver Different Packages",description:"Pick up packages and deliver them to matching color drop-offs. Some might be worth more..."}],j=C[l],D=(0,s.useCallback)(e=>{f(t=>t===e?null:e)},[]),R=(0,s.useCallback)(()=>{f(null)},[]),S=(0,s.useCallback)(()=>{_(e=>!e)},[]);return(0,s.useEffect)(()=>{let e=e=>{" "===e.key&&(e.preventDefault(),S())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[S]),(0,n.jsxs)("div",{className:x().tutorialContainer,children:[(0,n.jsx)(k,{taxisRef:g,deliveriesRef:w,pickupNodesRef:N,deliveryTimerRef:T,followTaxiId:p,isPaused:m}),(0,n.jsxs)("div",{className:x().tutorialOverlay,children:[(0,n.jsx)(c.l,{taxisRef:g,onTaxiSelect:D,onResetCamera:R,selectedTaxiId:p}),(0,n.jsxs)("div",{className:v().topLeft,style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,n.jsx)("button",{className:d().primary,onClick:()=>{i()},children:"Start Game"}),!y&&(0,n.jsx)("button",{className:d().secondary,onClick:()=>{b(!0)},children:"Show Tutorial"})]}),(0,n.jsx)("div",{className:v().bottomRight,children:(0,n.jsx)("button",{className:d().icon,onClick:S,children:m?(0,n.jsx)(o.A,{size:24}):(0,n.jsx)(a.A,{size:24})})}),(0,n.jsxs)("div",{className:h().moneyDisplay,children:["$",(null==(t=g.current[0])?void 0:t.money)||0]}),y&&(0,n.jsxs)("div",{className:x().instructionPanel,children:[(0,n.jsx)("h2",{className:x().stepTitle,children:j.title}),(0,n.jsx)("p",{className:x().stepDescription,children:j.description}),(0,n.jsxs)("div",{className:x().buttonGroup,children:[l>0&&(0,n.jsx)("button",{className:d().secondary,onClick:()=>{l>0&&u(l-1)},children:"Previous"}),(0,n.jsx)("button",{className:d().primary,onClick:()=>{l<C.length-1?u(l+1):b(!1)},children:l<C.length-1?"Next":"Play Tutorial"})]})]})]})]})}},6620:e=>{e.exports={tutorialContainer:"TutorialScene_tutorialContainer__JYRcU",tutorialOverlay:"TutorialScene_tutorialOverlay__Ur0l0",instructionPanel:"TutorialScene_instructionPanel__kcusO",stepTitle:"TutorialScene_stepTitle__EZ_Op",stepDescription:"TutorialScene_stepDescription__V1U_R",buttonGroup:"TutorialScene_buttonGroup__6nSDN"}}}]);
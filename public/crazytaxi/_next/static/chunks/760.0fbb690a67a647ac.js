"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[760],{6760:(e,o,s)=>{s.r(o),s.d(o,{default:()=>j});var i=s(5155),t=s(2115),n=s(258),l=s(6750),a=s(362),r=s(9080),d=s(7381),c=s(5503),f=s(9809),p=s(9585),h=s(2232),m=s(2324),u=s(3531),x=s(3946);function g(e){let{nodes:o,materials:s}=(0,u.p)((0,x.O)("models/the_og_shop.glb"));return(0,i.jsx)("group",{...e,dispose:null,children:(0,i.jsx)("group",{name:"Scene",userData:{blosm:{defaultLevels:[{levels:4,weight:10},{levels:5,weight:40},{levels:6,weight:10}]}},children:(0,i.jsx)("mesh",{name:"shop_og",geometry:o.shop_og.geometry,material:s["colormap.005"],position:[-7.326,0,10.822],rotation:[Math.PI/2,0,0],scale:1.303,userData:{name:"shop_og"}})})})}u.p.preload((0,x.O)("models/the_og_shop.glb"));let j=t.memo(function(e){let{taxisRef:o,deliveriesRef:s,pickupNodesRef:t,deliveryTimerRef:u,isPaused:x,debugMode:j,isRushHour:v,followTaxiId:R}=e;return(0,i.jsxs)(n.Hl,{camera:{position:[8,10,8],fov:50},shadows:!1,frameloop:"always",children:[(0,i.jsx)("ambientLight",{intensity:.6}),(0,i.jsx)("directionalLight",{position:[5,10,5],intensity:.8,castShadow:!1}),(0,i.jsx)(l.N,{enablePan:!0,enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2.2,minDistance:3,maxDistance:30,panSpeed:.8,makeDefault:!0}),(0,i.jsx)(m.m,{taxisRef:o,followTaxiId:R}),(0,i.jsx)(a.A,{}),(0,i.jsx)(r.A,{debugMode:j}),(0,i.jsx)(d.h,{}),(0,i.jsx)(p.m,{taxisRef:o,isPaused:x}),(0,i.jsx)(g,{}),(0,i.jsx)(f.C,{deliveriesRef:s,deliveryTimerRef:u,pickupNodesRef:t,taxisRef:o,isPaused:x,isRushHour:v}),(0,i.jsx)(c.I,{deliveriesRef:s,pickupNodesRef:t,taxisRef:o}),(0,i.jsx)(h.W,{taxisRef:o,deliveriesRef:s,isPaused:x})]})})},9080:(e,o,s)=>{s.d(o,{A:()=>a});var i=s(5155),t=s(1288),n=s(8946),l=s(5304);function a(e){let{debugMode:o}=e,s=(0,n.nt)();return(0,i.jsxs)("group",{children:[o&&s.paths.map(e=>{let o=e.points.map(e=>[e.x,e.y,e.z]);return(0,i.jsx)(t.N,{points:o,color:"#00ff88",lineWidth:2,dashed:!1},e.id)}),o&&s.nodes.map(e=>{let o="#888888";return(0,l.Xm)(e,"pickup")&&(o="#00ff00"),(0,l.Xm)(e,"dropoff")&&(o="#ff0000"),(0,l.Xm)(e,"red_light")&&(o="#ff8800"),(0,l.Xm)(e,"service")&&(o="#0088ff"),(0,l.Xm)(e,"intersection")&&(o="#ffff00"),(0,i.jsxs)("mesh",{position:e.position,children:[(0,i.jsx)("sphereGeometry",{args:[.2,8,8]}),(0,i.jsx)("meshStandardMaterial",{color:o,emissive:o,emissiveIntensity:.5})]},e.id)})]})}},9585:(e,o,s)=>{s.d(o,{m:()=>l});var i=s(9980),t=s(4510);function n(e){console.log("⏪ ".concat(e.id," reversing immediately at t=").concat(e.t.toFixed(2))),e.isReversing=!0,e.collisionCooldown=2e3}function l(e){let{taxisRef:o,isPaused:s}=e;return(0,i.D)((e,i)=>{s||!function(e,o){for(let s of e)s.collisionCooldown>0&&(s.collisionCooldown-=o);for(let o=0;o<e.length;o++)for(let s=o+1;s<e.length;s++){let i=e[o],l=e[s];if(i.collisionCooldown>0||l.collisionCooldown>0||i.isReversing||l.isReversing||!i.path||!l.path)continue;let a=(0,t.KQ)(i.path,i.t),r=(0,t.KQ)(l.path,l.t),d=a.distanceTo(r);d<.5&&(console.log("\uD83D\uDCA5 COLLISION: ".concat(i.id," ↔️ ").concat(l.id," (distance: ").concat(d.toFixed(2),")")),n(i),n(l))}}(o.current,1e3*i)}),null}}}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[946],{5946:(e,o,s)=>{s.r(o),s.d(o,{default:()=>y});var i=s(5155),t=s(2115),n=s(258),l=s(6750),a=s(362),r=s(1288),d=s(8946),c=s(5304);function f(e){let{debugMode:o}=e,s=(0,d.nt)();return(0,i.jsxs)("group",{children:[o&&s.paths.map(e=>{let o=e.points.map(e=>[e.x,e.y,e.z]);return(0,i.jsx)(r.N,{points:o,color:"#00ff88",lineWidth:2,dashed:!1},e.id)}),o&&s.nodes.map(e=>{let o="#888888";return(0,c.Xm)(e,"pickup")&&(o="#00ff00"),(0,c.Xm)(e,"dropoff")&&(o="#ff0000"),(0,c.Xm)(e,"red_light")&&(o="#ff8800"),(0,c.Xm)(e,"service")&&(o="#0088ff"),(0,c.Xm)(e,"intersection")&&(o="#ffff00"),(0,i.jsxs)("mesh",{position:e.position,children:[(0,i.jsx)("sphereGeometry",{args:[.2,8,8]}),(0,i.jsx)("meshStandardMaterial",{color:o,emissive:o,emissiveIntensity:.5})]},e.id)})]})}var p=s(7381),h=s(5503),u=s(9809),m=s(9980),x=s(4510);function g(e){console.log("⏪ ".concat(e.id," reversing immediately at t=").concat(e.t.toFixed(2))),e.isReversing=!0,e.collisionCooldown=2e3}function j(e){let{taxisRef:o,isPaused:s}=e;return(0,m.D)((e,i)=>{s||!function(e,o){for(let s of e)s.collisionCooldown>0&&(s.collisionCooldown-=o);for(let o=0;o<e.length;o++)for(let s=o+1;s<e.length;s++){let i=e[o],t=e[s];if(i.collisionCooldown>0||t.collisionCooldown>0||i.isReversing||t.isReversing||!i.path||!t.path)continue;let n=(0,x.KQ)(i.path,i.t),l=(0,x.KQ)(t.path,t.t),a=n.distanceTo(l);a<.5&&(console.log("\uD83D\uDCA5 COLLISION: ".concat(i.id," ↔️ ").concat(t.id," (distance: ").concat(a.toFixed(2),")")),g(i),g(t))}}(o.current,1e3*i)}),null}var v=s(2232),R=s(2324),w=s(3531),_=s(3946);function b(e){let{nodes:o,materials:s}=(0,w.p)((0,_.O)("models/the_og_shop.glb"));return(0,i.jsx)("group",{...e,dispose:null,children:(0,i.jsx)("group",{name:"Scene",userData:{blosm:{defaultLevels:[{levels:4,weight:10},{levels:5,weight:40},{levels:6,weight:10}]}},children:(0,i.jsx)("mesh",{name:"shop_og",geometry:o.shop_og.geometry,material:s["colormap.005"],position:[-7.326,0,10.822],rotation:[Math.PI/2,0,0],scale:1.303,userData:{name:"shop_og"}})})})}w.p.preload((0,_.O)("models/the_og_shop.glb"));let y=t.memo(function(e){let{taxisRef:o,deliveriesRef:s,pickupNodesRef:t,deliveryTimerRef:r,isPaused:d,debugMode:c,isRushHour:m,followTaxiId:x}=e;return(0,i.jsxs)(n.Hl,{camera:{position:[8,10,8],fov:50},shadows:!1,frameloop:"always",children:[(0,i.jsx)("ambientLight",{intensity:.6}),(0,i.jsx)("directionalLight",{position:[5,10,5],intensity:.8,castShadow:!1}),(0,i.jsx)(l.N,{enablePan:!0,enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2.2,minDistance:3,maxDistance:30,panSpeed:.8,makeDefault:!0}),(0,i.jsx)(R.m,{taxisRef:o,followTaxiId:x}),(0,i.jsx)(a.A,{}),(0,i.jsx)(f,{debugMode:c}),(0,i.jsx)(p.h,{}),(0,i.jsx)(j,{taxisRef:o,isPaused:d}),(0,i.jsx)(b,{}),(0,i.jsx)(u.C,{deliveriesRef:s,deliveryTimerRef:r,pickupNodesRef:t,taxisRef:o,isPaused:d,isRushHour:m}),(0,i.jsx)(h.I,{deliveriesRef:s,pickupNodesRef:t,taxisRef:o}),(0,i.jsx)(v.W,{taxisRef:o,deliveriesRef:s,isPaused:d})]})})}}]);
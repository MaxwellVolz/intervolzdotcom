"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[760],{6760:(e,o,s)=>{s.r(o),s.d(o,{default:()=>w});var t=s(5155),i=s(2115),n=s(9980),l=s(258),a=s(6750),r=s(5339),c=s(362),d=s(9080),f=s(7381),p=s(5503),u=s(9809),h=s(9585),m=s(2232),x=s(2324),g=s(3531),j=s(3946);function v(e){let{nodes:o,materials:s}=(0,g.p)((0,j.O)("models/the_og_shop.glb"));return(0,t.jsx)("group",{...e,dispose:null,children:(0,t.jsx)("group",{name:"Scene",userData:{blosm:{defaultLevels:[{levels:4,weight:10},{levels:5,weight:40},{levels:6,weight:10}]}},children:(0,t.jsx)("mesh",{name:"shop_og",geometry:o.shop_og.geometry,material:s["colormap.005"],position:[-7.326,0,10.822],rotation:[Math.PI/2,0,0],scale:1.303,userData:{name:"shop_og"}})})})}function R(){let{scene:e,gl:o}=(0,n.C)();return(0,i.useEffect)(()=>(e.fog=new r.cRK(987413,.035),o.outputColorSpace=r.er$,o.toneMapping=r.FV,o.toneMappingExposure=.9,()=>{e.fog=null}),[e,o]),null}g.p.preload((0,j.O)("models/the_og_shop.glb"));let w=i.memo(function(e){let{taxisRef:o,deliveriesRef:s,pickupNodesRef:i,deliveryTimerRef:n,isPaused:r,debugMode:g,isRushHour:j,followTaxiId:w}=e;return(0,t.jsxs)(l.Hl,{camera:{position:[8,10,8],fov:50},shadows:!1,frameloop:"always",children:[(0,t.jsx)(R,{}),(0,t.jsx)("ambientLight",{intensity:.6}),(0,t.jsx)("directionalLight",{position:[5,10,5],intensity:.8,castShadow:!1}),(0,t.jsx)(a.N,{enablePan:!0,enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2.2,minDistance:3,maxDistance:30,panSpeed:.8,makeDefault:!0}),(0,t.jsx)(x.m,{taxisRef:o,followTaxiId:w}),(0,t.jsx)(c.A,{}),(0,t.jsx)(d.A,{debugMode:g}),(0,t.jsx)(f.h,{}),(0,t.jsx)(h.m,{taxisRef:o,isPaused:r}),(0,t.jsx)(v,{}),(0,t.jsx)(u.C,{deliveriesRef:s,deliveryTimerRef:n,pickupNodesRef:i,taxisRef:o,isPaused:r,isRushHour:j}),(0,t.jsx)(p.I,{deliveriesRef:s,pickupNodesRef:i,taxisRef:o}),(0,t.jsx)(m.W,{taxisRef:o,deliveriesRef:s,isPaused:r})]})})},9080:(e,o,s)=>{s.d(o,{A:()=>a});var t=s(5155),i=s(1288),n=s(8946),l=s(5304);function a(e){let{debugMode:o}=e,s=(0,n.nt)();return(0,t.jsxs)("group",{children:[o&&s.paths.map(e=>{let o=e.points.map(e=>[e.x,e.y,e.z]);return(0,t.jsx)(i.N,{points:o,color:"#00ff88",lineWidth:2,dashed:!1},e.id)}),o&&s.nodes.map(e=>{let o="#888888";return(0,l.Xm)(e,"pickup")&&(o="#00ff00"),(0,l.Xm)(e,"dropoff")&&(o="#ff0000"),(0,l.Xm)(e,"red_light")&&(o="#ff8800"),(0,l.Xm)(e,"service")&&(o="#0088ff"),(0,l.Xm)(e,"intersection")&&(o="#ffff00"),(0,t.jsxs)("mesh",{position:e.position,children:[(0,t.jsx)("sphereGeometry",{args:[.2,8,8]}),(0,t.jsx)("meshStandardMaterial",{color:o,emissive:o,emissiveIntensity:.5})]},e.id)})]})}},9585:(e,o,s)=>{s.d(o,{m:()=>l});var t=s(9980),i=s(4510);function n(e){console.log("⏪ ".concat(e.id," reversing immediately at t=").concat(e.t.toFixed(2))),e.isReversing=!0,e.collisionCooldown=2e3}function l(e){let{taxisRef:o,isPaused:s}=e;return(0,t.D)((e,t)=>{s||!function(e,o){for(let s of e)s.collisionCooldown>0&&(s.collisionCooldown-=o);for(let o=0;o<e.length;o++)for(let s=o+1;s<e.length;s++){let t=e[o],l=e[s];if(t.collisionCooldown>0||l.collisionCooldown>0||t.isReversing||l.isReversing||!t.path||!l.path)continue;let a=(0,i.KQ)(t.path,t.t),r=(0,i.KQ)(l.path,l.t),c=a.distanceTo(r);c<.5&&(console.log("\uD83D\uDCA5 COLLISION: ".concat(t.id," ↔️ ").concat(l.id," (distance: ").concat(c.toFixed(2),")")),n(t),n(l))}}(o.current,1e3*t)}),null}}}]);
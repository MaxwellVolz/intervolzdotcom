(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{2462:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>w});var s=i(5155),l=i(2115),n=i(5921),a=i(3511),o=i(7909),r=i(8774),c=i(4476),u=i(3381),d=i.n(u),p=i(8615),h=i.n(p),x=i(9135),f=i.n(x),v=i(6620),m=i.n(v);let k=(0,o.default)(()=>Promise.all([i.e(687),i.e(443),i.e(506)]).then(i.bind(i,506)),{loadableGenerated:{webpack:()=>[506]},ssr:!1});function w(e){var t;let{onComplete:i}=e,[o,u]=(0,l.useState)(0),[p,x]=(0,l.useState)("tutorial-taxi-1"),[v,w]=(0,l.useState)(!1),[y,_]=(0,l.useState)(!0),{taxisRef:g,deliveriesRef:T,pickupNodesRef:b,deliveryTimerRef:N}=function(){let e=(0,l.useRef)([{id:"tutorial-taxi-1",state:"driving_to_pickup",path:null,t:0,speed:1.5,isFocused:!1,currentIntersectionId:void 0,incomingDir:0,previousNodeId:void 0,hasPackage:!1,currentDeliveryId:void 0,money:0,isReversing:!1,collisionCooldown:0,isReady:!1}]),t=(0,l.useRef)([]),i=(0,l.useRef)(1e4),s=(0,l.useRef)([]),n=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{let i=i=>{let{network:l}=i.detail;if(console.log("\uD83D\uDCDA Tutorial received road network update:",l),l.paths.length>0&&e.current[0]){let t=l.paths[0];e.current[0].path=t,e.current[0].t=0,e.current[0].isReady=!0,console.log("âœ… Tutorial taxi on path: ".concat(t.id)),console.log("   Total paths: ".concat(l.paths.length))}if(l.nodes){let e=l.nodes.filter(e=>e.types.includes("pickup"));if(s.current=e,console.log("\uD83D\uDCCD Tutorial has ".concat(e.length," pickup nodes")),e.length>=2&&!n.current){for(let i=0;i<2;i++){let i=(0,r.aK)(e,t.current);i&&t.current.push(i)}n.current=!0,console.log("\uD83C\uDFAE Tutorial spawned 2 initial deliveries")}}};return window.addEventListener("roadNetworkUpdated",i),()=>{window.removeEventListener("roadNetworkUpdated",i)}},[]),{taxisRef:e,deliveriesRef:t,pickupNodesRef:s,deliveryTimerRef:i}}(),j=[{title:"Yo, what up. First day?",description:"It's easy. The taxis will stay on the road, you just gotta direct them to the biggest packages."},{title:"Plus the controls are pretty chill.",description:"Tap an intersection to set the vibe. The next cab that rolls through will know what to do."},{title:"Just follow the neon lights.",description:"Once you pickup a box, the cabs underglow will match the dropoff rings. Get it there ASAP."}],C=j[o],R=(0,l.useCallback)(e=>{x(t=>t===e?null:e)},[]),D=(0,l.useCallback)(()=>{x(null)},[]),S=(0,l.useCallback)(()=>{w(e=>!e)},[]);return(0,l.useEffect)(()=>{let e=e=>{" "===e.key&&(e.preventDefault(),S())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[S]),(0,s.jsxs)("div",{className:m().tutorialContainer,children:[(0,s.jsx)(k,{taxisRef:g,deliveriesRef:T,pickupNodesRef:b,deliveryTimerRef:N,followTaxiId:p,isPaused:v}),(0,s.jsxs)("div",{className:m().tutorialOverlay,children:[(0,s.jsx)(c.l,{taxisRef:g,onTaxiSelect:R,onResetCamera:D,selectedTaxiId:p}),(0,s.jsxs)("div",{className:f().topLeft,style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,s.jsx)("button",{className:d().primary,onClick:()=>{i()},children:"Start Game"}),!y&&(0,s.jsx)("button",{className:d().secondary,onClick:()=>{_(!0)},children:"Show Tutorial"})]}),(0,s.jsx)("div",{className:f().bottomRight,children:(0,s.jsx)("button",{className:d().icon,onClick:S,children:v?(0,s.jsx)(n.A,{size:24}):(0,s.jsx)(a.A,{size:24})})}),(0,s.jsxs)("div",{className:h().moneyDisplay,children:["$",(null==(t=g.current[0])?void 0:t.money)||0]}),y&&(0,s.jsxs)("div",{className:m().instructionPanel,children:[(0,s.jsx)("h2",{className:m().stepTitle,children:C.title}),(0,s.jsx)("p",{className:m().stepDescription,children:C.description}),(0,s.jsxs)("div",{className:m().buttonGroup,children:[o>0&&(0,s.jsx)("button",{className:d().secondary,onClick:()=>{o>0&&u(o-1)},children:"Previous"}),(0,s.jsx)("button",{className:d().primary,onClick:()=>{o<j.length-1?u(o+1):_(!1)},children:o<j.length-1?"Next":"Play Tutorial"})]})]})]})]})}},6620:e=>{e.exports={tutorialContainer:"TutorialScene_tutorialContainer__JYRcU",tutorialOverlay:"TutorialScene_tutorialOverlay__Ur0l0",instructionPanel:"TutorialScene_instructionPanel__kcusO",stepTitle:"TutorialScene_stepTitle__EZ_Op",stepDescription:"TutorialScene_stepDescription__V1U_R",buttonGroup:"TutorialScene_buttonGroup__6nSDN"}}}]);